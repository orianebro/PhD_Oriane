<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Oriane Braud">

<title>3&nbsp; Structural cereal model – PhD Oriane</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./dynamic_model.html" rel="next">
<link href="./intro_1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./year_1.html">First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability</a></li><li class="breadcrumb-item"><a href="./structural_cereal_model.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Structural cereal model</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">PhD Oriane</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstract.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abstract</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./year_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structural_cereal_model.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Structural cereal model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Dynamic model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./light_inter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Light interception with Caribu</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./year_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Second chapter : Analyzing accuracy of formalisms in crop model when adding root structural variability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./year_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Third chapter: Improving STICS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#create-a-parametric-leaf" id="toc-create-a-parametric-leaf" class="nav-link active" data-scroll-target="#create-a-parametric-leaf"><span class="header-section-number">3.1</span> Create a parametric leaf</a></li>
  <li><a href="#generate-leaf-azimuth-series" id="toc-generate-leaf-azimuth-series" class="nav-link" data-scroll-target="#generate-leaf-azimuth-series"><span class="header-section-number">3.2</span> Generate leaf azimuth series</a></li>
  <li><a href="#manage-internode-lengths" id="toc-manage-internode-lengths" class="nav-link" data-scroll-target="#manage-internode-lengths"><span class="header-section-number">3.3</span> Manage internode lengths</a></li>
  <li><a href="#manage-leaf-lengths-as-a-function-of-height" id="toc-manage-leaf-lengths-as-a-function-of-height" class="nav-link" data-scroll-target="#manage-leaf-lengths-as-a-function-of-height"><span class="header-section-number">3.4</span> Manage leaf lengths as a function of height</a></li>
  <li><a href="#arrange-a-leaf-to-be-placed-along-a-stem-with-a-given-inclination." id="toc-arrange-a-leaf-to-be-placed-along-a-stem-with-a-given-inclination." class="nav-link" data-scroll-target="#arrange-a-leaf-to-be-placed-along-a-stem-with-a-given-inclination."><span class="header-section-number">3.5</span> Arrange a leaf to be placed along a stem with a given inclination.</a></li>
  <li><a href="#build-the-whole-plant-shoot-in-3d-as-an-mtg." id="toc-build-the-whole-plant-shoot-in-3d-as-an-mtg." class="nav-link" data-scroll-target="#build-the-whole-plant-shoot-in-3d-as-an-mtg."><span class="header-section-number">3.6</span> Build the whole plant shoot in 3D, as an MTG.</a></li>
  <li><a href="#display-scenes-according-to-different-scenarii" id="toc-display-scenes-according-to-different-scenarii" class="nav-link" data-scroll-target="#display-scenes-according-to-different-scenarii"><span class="header-section-number">3.7</span> Display scenes according to different scenarii</a>
  <ul class="collapse">
  <li><a href="#a-single-cereal" id="toc-a-single-cereal" class="nav-link" data-scroll-target="#a-single-cereal"><span class="header-section-number">3.7.1</span> A single cereal</a></li>
  <li><a href="#a-cereal-crop-with-variability" id="toc-a-cereal-crop-with-variability" class="nav-link" data-scroll-target="#a-cereal-crop-with-variability"><span class="header-section-number">3.7.2</span> A cereal crop with variability</a></li>
  <li><a href="#an-intercrop-organized-in-rows" id="toc-an-intercrop-organized-in-rows" class="nav-link" data-scroll-target="#an-intercrop-organized-in-rows"><span class="header-section-number">3.7.3</span> An intercrop organized in rows</a></li>
  </ul></li>
  <li><a href="#tillering-branching" id="toc-tillering-branching" class="nav-link" data-scroll-target="#tillering-branching"><span class="header-section-number">3.8</span> Tillering / Branching</a></li>
  <li><a href="#next-steps" id="toc-next-steps" class="nav-link" data-scroll-target="#next-steps"><span class="header-section-number">3.9</span> Next steps</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./year_1.html">First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability</a></li><li class="breadcrumb-item"><a href="./structural_cereal_model.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Structural cereal model</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Structural cereal model</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Oriane Braud </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>ReviewNB link: https://app.reviewnb.com/orianebro/PhD_Oriane/blob/main/structural_cereal_model.ipynb</p>
<div id="cell-5" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Deep reload</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In this section, we define a static structural model for cereals.<br>
The paragraphs are organized so that it is easy to see how the model is built and how we can play with parameters.</p>
<p>Some 3D plots are interactive, don’t hesitate to rotate them.</p>
<section id="create-a-parametric-leaf" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="create-a-parametric-leaf"><span class="header-section-number">3.1</span> Create a parametric leaf</h2>
<p>The leaf blade is represented as a surface.<br>
A parametric leaf is here defined by sample points (here 12), described by two sets of coordinates:<br>
- <span class="math inline">\((x,y)\)</span>: coordinates for the midrib in a vertical plane, give the curvature of the leaf;<br>
- <span class="math inline">\((s,r)\)</span>: curviliear abcissa (i.e.&nbsp;length along midrib) and relative length-dependent leaf width.</p>
<p>Note that <span class="math inline">\(s\)</span> can be expressed as a function of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, at point <span class="math inline">\(p \neq 0\)</span>, as follows: $ s_p(x,y) = $.</p>
<p>The origin represents the leaf base.</p>
<div id="cell-8" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Imports</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># from installed packages</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> heapq <span class="im">import</span> <span class="op">*</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.interpolate <span class="im">import</span> splprep, splev</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> simps, trapz</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openalea.plantgl.<span class="bu">all</span> <span class="im">import</span> Vector3</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># from openalea.openalea.archicrop</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openalea.archicrop.cereals_leaf <span class="im">import</span> leaf_shape_perez, sr_prevot, parametric_leaf</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># from openalea.openalea.archicrop.simple_maize import leaf_shape_perez, sr_prevot, parametric_leaf</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># from openalea.openalea.archicrop.fitting import leaf_shape_perez</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openalea.archicrop.generator <span class="im">import</span> curvilinear_abscisse</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openalea.archicrop.fitting <span class="im">import</span> fit2, fit3, simplify</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openalea.archicrop.simplification <span class="im">import</span> distance, cost</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co">## Code for generating a parametric leaf for a cereal </span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>pl<span class="op">=</span>parametric_leaf(nb_segment<span class="op">=</span><span class="dv">10</span>, insertion_angle<span class="op">=</span><span class="dv">40</span>, scurv<span class="op">=</span><span class="fl">0.7</span>, curvature<span class="op">=</span><span class="dv">70</span>, alpha<span class="op">=-</span><span class="fl">2.3</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">2</span>) </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.suptitle('Parametric leaf')</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>ax1.plot(pl[<span class="dv">0</span>], pl[<span class="dv">1</span>], <span class="st">'.-'</span>, c<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'y'</span>)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">"Coordinates of the midrib in a vertical plane"</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>ax2.plot(pl[<span class="dv">2</span>], pl[<span class="dv">3</span>], <span class="st">'-'</span>, c<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>ax2.plot(pl[<span class="dv">2</span>], <span class="op">-</span>pl[<span class="dv">3</span>], <span class="st">'-'</span>, c<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>ax2.plot(np.arange(<span class="dv">0</span>,<span class="fl">1.1</span>,<span class="fl">0.1</span>), np.zeros(<span class="dv">11</span>), c<span class="op">=</span><span class="st">"green"</span>, ls<span class="op">=</span><span class="st">"dashed"</span>)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'s'</span>)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'r'</span>)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">"Flattened leaf shape"</span>)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="structural_cereal_model_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-9" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Imports</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># from installed packages</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.mplot3d <span class="im">import</span> Axes3D</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.interpolate <span class="im">import</span> interp2d</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.tri <span class="im">as</span> mtri</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># from openalea.archicrop</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openalea.archicrop.fitting <span class="im">import</span> leaf_to_mesh_2d</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">## Code for representing the parametric leaf in 3D (ignore excess lines)</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>pl[<span class="dv">0</span>]</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>pl[<span class="dv">1</span>]</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>s<span class="op">=</span>pl[<span class="dv">2</span>]</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>r<span class="op">=</span>pl[<span class="dv">3</span>]</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>pts,ind<span class="op">=</span>leaf_to_mesh_2d(x, y, r)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>xs<span class="op">=</span>[pt[<span class="dv">0</span>] <span class="cf">for</span> pt <span class="kw">in</span> pts]</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>ys<span class="op">=</span>[pt[<span class="dv">1</span>] <span class="cf">for</span> pt <span class="kw">in</span> pts]</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>zs<span class="op">=</span>[pt[<span class="dv">2</span>] <span class="cf">for</span> pt <span class="kw">in</span> pts]</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>X,Y<span class="op">=</span>np.meshgrid(xs, ys)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>tri<span class="op">=</span>mtri.Triangulation(xs, ys)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure()</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>fig.add_subplot(<span class="dv">111</span>, projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>ax.scatter(xs,ys,zs,c<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>ax.plot(xs,ys,zs,c<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>ax.plot(xs,np.zeros(<span class="bu">len</span>(ys)),zs,c<span class="op">=</span><span class="st">"green"</span>,ls<span class="op">=</span><span class="st">"dashed"</span>)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"3D representation of a leaf shape with curvature"</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="structural_cereal_model_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Please ignore excess straight lines.</p>
<div id="cell-11" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># from openalea.archicrop</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openalea.archicrop.cereals_leaf <span class="im">import</span> parametric_leaf</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openalea.archicrop.geometry <span class="im">import</span> leaf_mesh_for_growth, stem_mesh</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simple_leaf(leaf, ratio):</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    total_length <span class="op">=</span> <span class="dv">80</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    lw_ratio <span class="op">=</span> <span class="fl">7.0</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    L_shape <span class="op">=</span> total_length</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    Lw_shape <span class="op">=</span> total_length <span class="op">/</span> lw_ratio</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    length <span class="op">=</span> total_length <span class="op">*</span> ratio</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    s_base <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    s_top <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> leaf_mesh_for_growth(leaf, L_shape, Lw_shape, length, s_base, s_top)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-12" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openalea.plantgl.<span class="bu">all</span> <span class="im">import</span> Vector3</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> oawidgets.plantgl <span class="im">import</span> <span class="op">*</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># leaf = parametric_leaf(insertion_angle=30, scurv=0.6, curvature=130, alpha=-2.3)</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>leaf <span class="op">=</span> parametric_leaf(insertion_angle<span class="op">=</span><span class="dv">0</span>, scurv<span class="op">=</span><span class="fl">0.5</span>, curvature<span class="op">=</span><span class="dv">0</span>, alpha<span class="op">=-</span><span class="fl">2.3</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>mesh <span class="op">=</span> simple_leaf(leaf, <span class="dv">1</span>) </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>PlantGL(mesh)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 326400</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="7">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0539d748a22248e5bb4214e69132131f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
</section>
<section id="generate-leaf-azimuth-series" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="generate-leaf-azimuth-series"><span class="header-section-number">3.2</span> Generate leaf azimuth series</h2>
<p>Leaves grow around an axis with a given phyllotaxy, represented here as an angle from leaf to leaf (e.g.&nbsp;spiral with a given angle or alternate distichous = <span class="math inline">\(180^o\)</span>).</p>
<div id="cell-15" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Imports</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># from installed packages </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># from itertools import cycle</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># from openalea.archicrop</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openalea.archicrop.plant_design <span class="im">import</span> leaf_azimuth</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">## Code for generating leaf azimuths series for a given phyllotaxy</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>nb_phy<span class="op">=</span><span class="dv">10</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>phyllotactic_angle<span class="op">=</span><span class="dv">137</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>spiral<span class="op">=</span><span class="va">True</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>phyllotactic_deviation<span class="op">=</span><span class="dv">0</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>plant_orientation<span class="op">=</span><span class="dv">0</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>la<span class="op">=</span>leaf_azimuth(size<span class="op">=</span>nb_phy, </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>                phyllotactic_angle<span class="op">=</span>phyllotactic_angle, </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>                phyllotactic_deviation<span class="op">=</span>phyllotactic_deviation, </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>                plant_orientation<span class="op">=</span>plant_orientation, </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>                spiral<span class="op">=</span>spiral)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>np.cos(la<span class="op">*</span>np.pi<span class="op">/</span><span class="dv">180</span>)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>np.sin(la<span class="op">*</span>np.pi<span class="op">/</span><span class="dv">180</span>)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>z<span class="op">=</span>np.linspace(<span class="dv">1</span>,<span class="bu">len</span>(la)<span class="op">+</span><span class="dv">1</span>,<span class="bu">len</span>(la))</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>fig,ax<span class="op">=</span>plt.subplots(subplot_kw<span class="op">=</span><span class="bu">dict</span>(projection<span class="op">=</span><span class="st">'3d'</span>))</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i,a <span class="kw">in</span> <span class="bu">enumerate</span>(la):</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    ax.plot(np.linspace(<span class="dv">0</span>,x[i],<span class="dv">2</span>), np.linspace(<span class="dv">0</span>,y[i],<span class="dv">2</span>), [z[i],z[i]], c<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>ax.plot([<span class="dv">0</span>,<span class="dv">0</span>], [<span class="dv">0</span>,<span class="dv">0</span>], [<span class="dv">0</span>,z[<span class="op">-</span><span class="dv">1</span>]], c<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"3D representation of phyllotaxy"</span>)</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="structural_cereal_model_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="manage-internode-lengths" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="manage-internode-lengths"><span class="header-section-number">3.3</span> Manage internode lengths</h2>
<p>Internodes on an axis have varying lengths. The repartition of their lengths along the axis can be approximated with a geometric model.</p>
<div id="cell-18" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Imports</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openalea.archicrop.plant_shape <span class="im">import</span> geometric_dist</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Code for applying lengths to internodes according to a geometric model</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>plant_height<span class="op">=</span><span class="dv">15</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>q<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>np.cos(la<span class="op">*</span>np.pi<span class="op">/</span><span class="dv">180</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>np.sin(la<span class="op">*</span>np.pi<span class="op">/</span><span class="dv">180</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>z<span class="op">=</span>geometric_dist(height<span class="op">=</span>plant_height, </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                   nb_phy<span class="op">=</span>nb_phy, </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>                   q<span class="op">=</span>q)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>fig,ax<span class="op">=</span>plt.subplots(subplot_kw<span class="op">=</span><span class="bu">dict</span>(projection<span class="op">=</span><span class="st">'3d'</span>))</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i,a <span class="kw">in</span> <span class="bu">enumerate</span>(la):</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    ax.plot(np.linspace(<span class="dv">0</span>,x[i],<span class="dv">2</span>), np.linspace(<span class="dv">0</span>,y[i],<span class="dv">2</span>), [z[i],z[i]], c<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>ax.plot([<span class="dv">0</span>,<span class="dv">0</span>], [<span class="dv">0</span>,<span class="dv">0</span>], [<span class="dv">0</span>,z[<span class="op">-</span><span class="dv">1</span>]], c<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"3D representation of the repartition of internode length along the stem"</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="structural_cereal_model_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="manage-leaf-lengths-as-a-function-of-height" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="manage-leaf-lengths-as-a-function-of-height"><span class="header-section-number">3.4</span> Manage leaf lengths as a function of height</h2>
<p>Leaves that grow on an axis have varying lengths. The repartition of their lengths along the axis can be approximated with a bell shaped model.</p>
<div id="cell-21" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Imports</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openalea.archicrop.plant_shape <span class="im">import</span> bell_shaped_dist</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Code for applying lengths to leaves according to a bell shaped model</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>max_leaf_length<span class="op">=</span><span class="dv">50</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>bsd<span class="op">=</span>bell_shaped_dist(max_leaf_length<span class="op">=</span>max_leaf_length, </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                     nb_phy<span class="op">=</span>nb_phy, </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                     rmax<span class="op">=</span><span class="fl">.8</span>, </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                     skew<span class="op">=</span><span class="fl">0.15</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>np.cos(la<span class="op">*</span>np.pi<span class="op">/</span><span class="dv">180</span>)<span class="op">*</span>bsd</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>np.sin(la<span class="op">*</span>np.pi<span class="op">/</span><span class="dv">180</span>)<span class="op">*</span>bsd</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>z<span class="op">=</span>geometric_dist(height<span class="op">=</span>plant_height, </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                   nb_phy<span class="op">=</span>nb_phy, </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                   q<span class="op">=</span>q)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(subplot_kw<span class="op">=</span><span class="bu">dict</span>(projection<span class="op">=</span><span class="st">'3d'</span>))</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i,a <span class="kw">in</span> <span class="bu">enumerate</span>(la):</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    ax.plot(np.linspace(<span class="dv">0</span>,x[i],<span class="dv">2</span>), np.linspace(<span class="dv">0</span>,y[i],<span class="dv">2</span>), [z[i],z[i]], c<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>ax.plot([<span class="dv">0</span>,<span class="dv">0</span>], [<span class="dv">0</span>,<span class="dv">0</span>], [<span class="dv">0</span>,z[<span class="op">-</span><span class="dv">1</span>]], c<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"3D representation of the repartition of leaf length along the stem"</span>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="structural_cereal_model_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="arrange-a-leaf-to-be-placed-along-a-stem-with-a-given-inclination." class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="arrange-a-leaf-to-be-placed-along-a-stem-with-a-given-inclination."><span class="header-section-number">3.5</span> Arrange a leaf to be placed along a stem with a given inclination.</h2>
<p>A leaf must undergo a translation to be placed against the surface of the stem (tangent to it), and a rotation to be tilted like the stem (inclination = 1 if main stem).</p>
<div id="cell-24" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Imports</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># from installed packages</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> pi, cos, sin, radians</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> openalea.plantgl.<span class="bu">all</span> <span class="im">as</span> pgl</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># from openalea.archicrop</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># from openalea.archicrop.cereals_leaf import arrange_leaf</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># or </span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openalea.archicrop.geometry <span class="im">import</span> arrange_leaf</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">## Code for placing a leaf against a stem element (here a cylinder), with a given inclination</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>stem_diameter<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>inclination<span class="op">=</span><span class="dv">1</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>al<span class="op">=</span>arrange_leaf(leaf<span class="op">=</span>pl, </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>                stem_diameter<span class="op">=</span>stem_diameter, </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>                inclination<span class="op">=</span>inclination, </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>                relative<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>al[<span class="dv">0</span>]</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>al[<span class="dv">1</span>]</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>s<span class="op">=</span>al[<span class="dv">2</span>]</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>r<span class="op">=</span>al[<span class="dv">3</span>]</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>pts,ind<span class="op">=</span>leaf_to_mesh_2d(x, y, r)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>xs<span class="op">=</span>[pt[<span class="dv">0</span>] <span class="cf">for</span> pt <span class="kw">in</span> pts]</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>ys<span class="op">=</span>[pt[<span class="dv">1</span>] <span class="cf">for</span> pt <span class="kw">in</span> pts]</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>zs<span class="op">=</span>[pt[<span class="dv">2</span>] <span class="cf">for</span> pt <span class="kw">in</span> pts]</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>X,Y<span class="op">=</span>np.meshgrid(xs, ys)</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>tri<span class="op">=</span>mtri.Triangulation(xs, ys)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure()</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>fig.add_subplot(<span class="dv">111</span>, projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>ax.plot(xs,ys,zs,c<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>ax.plot([xs[<span class="dv">0</span>],xs[<span class="dv">0</span>]],[ys[<span class="dv">0</span>],<span class="op">-</span>ys[<span class="dv">0</span>]],[<span class="dv">0</span>,<span class="dv">0</span>],c<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>ax.plot(xs,np.zeros(<span class="bu">len</span>(ys)),zs,c<span class="op">=</span><span class="st">"green"</span>,ls<span class="op">=</span><span class="st">"dashed"</span>)</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>radius<span class="op">=</span>stem_diameter<span class="op">/</span><span class="dv">2</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>z<span class="op">=</span>np.linspace(<span class="op">-</span>zs[<span class="op">-</span><span class="dv">1</span>], zs[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>theta<span class="op">=</span>np.linspace(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>np.pi)</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>theta_grid, z_stem<span class="op">=</span>np.meshgrid(theta, z)</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>x_stem<span class="op">=</span>radius<span class="op">*</span>np.cos(theta_grid)</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>y_stem<span class="op">=</span>radius<span class="op">*</span>np.sin(theta_grid)</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>ax.plot_surface(x_stem, y_stem, z_stem, color<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"3D representation of the placement of a leaf along a stem"</span>)</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="structural_cereal_model_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="build-the-whole-plant-shoot-in-3d-as-an-mtg." class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="build-the-whole-plant-shoot-in-3d-as-an-mtg."><span class="header-section-number">3.6</span> Build the whole plant shoot in 3D, as an MTG.</h2>
<p>An MTG (Multiscale Tree Graph) is created as a representation of a parametrized cereal shoot.<br>
The different scales are: - Plant<br>
- Axis<br>
- Stem / Leaf</p>
<div id="cell-27" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Imports</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># from installed packages</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> openalea.plantgl.<span class="bu">all</span> <span class="im">as</span> pgl</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openalea.mtg.turtle <span class="im">import</span> TurtleFrame</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openalea.mtg <span class="im">import</span> MTG, fat_mtg</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.interpolate <span class="im">import</span> interp1d</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># from openalea.archicrop</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openalea.archicrop.cereals <span class="im">import</span> build_shoot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="display-scenes-according-to-different-scenarii" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="display-scenes-according-to-different-scenarii"><span class="header-section-number">3.7</span> Display scenes according to different scenarii</h2>
<div id="cell-29" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Imports</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># from installed packages</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> oawidgets.plantgl <span class="im">import</span> <span class="op">*</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set nice color for plants</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>nice_green<span class="op">=</span>Color3((<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="a-single-cereal" class="level3" data-number="3.7.1">
<h3 data-number="3.7.1" class="anchored" data-anchor-id="a-single-cereal"><span class="header-section-number">3.7.1</span> A single cereal</h3>
<div id="cell-31" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Imports</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># from installed packages</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> oawidgets.plantgl <span class="im">import</span> <span class="op">*</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># from openalea.archicrop</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openalea.archicrop.display <span class="im">import</span> display_mtg, build_scene, display_scene</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable plotting with PlantGL</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>gui qt</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">## Code for generating a 3D cereal shoot from descritive parameters</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters </span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>height<span class="op">=</span><span class="dv">220</span>                 </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>nb_phy<span class="op">=</span><span class="dv">22</span> <span class="co"># (15, 25, 35) # 22</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>max_leaf_length<span class="op">=</span><span class="dv">90</span> <span class="co"># (60, 90, 120) # 90</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>shoot, g <span class="op">=</span> build_shoot(nb_phy<span class="op">=</span>nb_phy,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>                        height<span class="op">=</span>height,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>                        max_leaf_length<span class="op">=</span>max_leaf_length,</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>                        wl<span class="op">=</span><span class="fl">0.12</span>, <span class="co"># (0.1, 0.13) # 0.12</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>                        diam_base<span class="op">=</span><span class="fl">2.5</span>, </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>                        diam_top<span class="op">=</span><span class="fl">0.5</span>, </span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>                        insertion_angle<span class="op">=</span><span class="dv">30</span>, <span class="co"># (30, 60) # 30</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>                        scurv<span class="op">=</span><span class="fl">0.6</span>, <span class="co"># (0.3, 0.6, 0.9) # 0.6</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>                        curvature<span class="op">=</span><span class="dv">135</span>, <span class="co"># (0, 45, 90, 135) # 130</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>                        alpha<span class="op">=-</span><span class="fl">2.3</span>, </span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>                        stem_q<span class="op">=</span><span class="dv">1</span>, <span class="co"># (1, 1.1)</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>                        rmax<span class="op">=</span><span class="fl">0.67</span>, </span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>                        skew<span class="op">=</span><span class="fl">0.05</span>, <span class="co"># 0.0005</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>                        phyllotactic_angle<span class="op">=</span><span class="dv">180</span>,</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>                        phyllotactic_deviation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Build and display scene</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>scene_single, nump <span class="op">=</span> build_scene(g, </span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>                                 leaf_material<span class="op">=</span>Material(nice_green), </span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>                                 stem_material<span class="op">=</span>Material(nice_green))</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a><span class="co"># display_scene(scene_single) # display in separate window</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>PlantGL(scene_single) <span class="co"># display in notebook</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="14">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4e977b052fe64df7912db42b59016742","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<div id="cell-32" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span>(g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Help on MTG in module openalea.mtg.mtg object:

class MTG(openalea.mtg.tree.PropertyTree)
 |  MTG(filename='', has_date=False)
 |
 |  A Multiscale Tree Graph (MTG) class.
 |
 |  MTGs describe tree structures at different levels
 |  of details, named scales.
 |  For example, a botanist can described plants at different scales :
 |
 |      - at scale 0, the whole scene.
 |      - at scale 1, the individual plants.
 |      - at scale 2, the axes of each plants.
 |      - at scale 3, the growth units of each axis, and so on.
 |
 |  Each scale can have a label, e.g. :
 |
 |   - scale 1 : P(lant)
 |   - scale 2 : A(xis)
 |   - sclae 3 : U(nit of growth)
 |
 |  Compared to a classical tree, :func:`complex` can be seen as :func:`parent`
 |  and :func:`components` as :func:`children`.
 |  An element at :func:`scale` N belongs to a :func:`complex` at :func:`scale` N-1 and has :func:`components` at scale N+1:
 |
 |   - /P/A/U (decomposition is noted using "/")
 |
 |  Each scale is itself described as a tree or a forest (i.e. set of trees), e.g.:
 |
 |   - /P1/P2/P3
 |   - A1+A2&lt;A3
 |   - ...
 |
 |  Method resolution order:
 |      MTG
 |      openalea.mtg.tree.PropertyTree
 |      openalea.mtg.tree.Tree
 |      builtins.object
 |
 |  Methods defined here:
 |
 |  AlgHeight(self, v1, v2)
 |      Algebraic value defining the number of components between two components.
 |
 |      This function is similar to function `Height(v1, v2)` : it returns the number of components
 |      between two components, at the same scale, but takes into account the order of vertices
 |      `v1` and `v2`.
 |
 |      The result is positive if `v1` is an ancestor of `v2`,
 |      and negative if `v2` is an ancestor of `v1`.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          AlgHeight(v1, v2)
 |
 |      :Parameters:
 |
 |          - v1 (int) : vertex of the active MTG.
 |          - v2 (int) : vertex of the active MTG.
 |
 |      :Returns:
 |
 |          int
 |
 |          If `v1` is not an ancestor of `v2` (or vise versa), or if `v1` and `v2` are not defined
 |          at the same scale, an error value None is returned.
 |
 |      .. seealso:: :func:`MTG`, :func:`Rank`, :func:`Order`, :func:`Height`, :func:`EdgeType`, :func:`AlgOrder`, :func:`AlgRank`.
 |
 |  AlgOrder(self, v1, v2)
 |      Algebraic value defining the relative order of one vertex with respect to another one.
 |
 |      This function is similar to function `Order(v1, v2)` : it returns the number of `+`-type edges
 |      between two components, at the same scale, but takes into account the order of vertices
 |      `v1` and `v2`.
 |
 |      The result is positive if `v1` is an ancestor of `v2`,
 |      and negative if `v2` is an ancestor of `v1`.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          AlgOrder(v1, v2)
 |
 |      :Parameters:
 |
 |          - v1 (int) : vertex of the active MTG.
 |          - v2 (int) : vertex of the active MTG.
 |
 |      :Returns:
 |
 |          int
 |
 |          If `v1` is not an ancestor of `v2` (or vise versa), or if `v1` and `v2` are not defined
 |          at the same scale, an error value None is returned.
 |
 |
 |      .. seealso:: :func:`MTG`, :func:`Rank`, :func:`Order`, :func:`Height`, :func:`EdgeType`, :func:`AlgHeight`, :func:`AlgRank`.
 |
 |  AlgRank(self, v1, v2)
 |      Algebraic value defining the relative rank of one vertex with respect to another one.
 |
 |      This function is similar to function `Rank(v1, v2)` : it returns the number of `&lt;`-type edges
 |      between two components, at the same scale, but takes into account the order of vertices
 |      `v1` and `v2`.
 |
 |      The result is positive if `v1` is an ancestor of `v2`,
 |      and negative if `v2` is an ancestor of `v1`.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          AlgRank(v1, v2)
 |
 |      :Parameters:
 |
 |          - v1 (int) : vertex of the active MTG.
 |          - v2 (int) : vertex of the active MTG.
 |
 |      :Returns:
 |
 |          int
 |
 |          If `v1` is not an ancestor of `v2` (or vise versa), or if `v1` and `v2` are not defined
 |          at the same scale, an error value None is returned.
 |
 |      .. seealso:: :func:`MTG`, :func:`Rank`, :func:`Order`, :func:`Height`, :func:`EdgeType`, :func:`AlgHeight`, :func:`AlgOrder`.
 |
 |  Ancestors(self, v, EdgeType='*', RestrictedTo='NoRestriction', ContainedIn=None)
 |      Array of all vertices which are ancestors of a given vertex
 |
 |      This function returns the array of vertices which are located
 |      before the vertex passed as an argument.
 |      These vertices are defined at the same scale as `v`. The array starts by `v`,
 |      then contains the vertices on the path from `v` back to the root (in this order)
 |      and finishes by the tree root.
 |
 |      .. note:: The anscestor array always contains at least the argument vertex `v`.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          g.Ancestors(v)
 |
 |      :Parameters:
 |
 |          - v (int) : vertex of the active MTG
 |
 |      :Optional Parameters:
 |
 |          - RestrictedTo (str): cf. `Father`
 |          - ContainedIn (int): cf. `Father`
 |          - EdgeType (str): cf. `Father`
 |
 |      :Returns:
 |
 |          list of vertices's id (int)
 |
 |
 |      :Examples:
 |
 |      .. code-block:: python
 |
 |          &gt;&gt;&gt; v # prints vertex v
 |          78
 |          &gt;&gt;&gt; g.Ancestors(v) # set of ancestors of v at the same scale
 |          [78,45,32,10,4]
 |          &gt;&gt;&gt; list(reversed(g.Ancestors(v))) # To get the vertices in the order from the root to the vertex v
 |          [4,10,32,45,78]
 |
 |
 |      .. seealso:: :func:`MTG`, :func:`Descendants`.
 |
 |  Axis(self, v, Scale=-1)
 |      Array of vertices constituting a botanical axis
 |
 |      An axis is a maximal sequence of vertices connected by '&lt;'-type edges.
 |      Axis return the array of vertices representing the botanical axis which the argument v belongs to.
 |      The optional argument enables the user to choose the scale at which the axis decomposition is required.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          Axis(v)
 |          Axis(v, Scale=s)
 |
 |      :Parameters:
 |
 |          - v (int) : Vertex of the active MTG
 |
 |      :Optional Parameters:
 |
 |          - Scale (str): scale at which the axis components are required.
 |
 |      :Returns:
 |
 |          list of vertices ids
 |
 |      .. image:: ../user/mtg_axis.png
 |
 |      .. seealso:: :func:`MTG`, :func:`Path`, :func:`Ancestors`.
 |
 |  Class = class_name(self, vid)
 |
 |  ClassScale(self, c)
 |      Scale at which appears a given class of vertex
 |
 |      Every vertex is associated with a unique class.
 |      Vertices from a given class only appear at a given scale
 |      which can be retrieved using this function.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          ClassScale(c)
 |
 |      :Parameters:
 |
 |          - `c` (str) : symbol of the considered class
 |
 |      :Returns:
 |
 |          int
 |
 |      .. seealso:: :func:`MTG`, :func:`Class`, :func:`Scale`, :func:`Index`.
 |
 |  Complex(self, v, Scale=-1)
 |      Complex of a vertex.
 |
 |      Returns the complex of `v`. The complex of a vertex `v` has a scale lower than `v` :
 |      `Scale(v)` - 1. In a MTG, every vertex except for the MTG root (cf. `MTGRoot`),
 |      has a uniq complex. None is returned if the argument is the MTG Root
 |      or if the vertex is undefined.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          g.Complex(v)
 |          g.Complex(v, Scale=2)
 |
 |      :Parameters:
 |
 |          - `v` (int) : vertex of the active MTG
 |
 |      :Optional Parameters:
 |
 |          - `Scale` (int) : scale of the complex
 |
 |      :Returns:
 |
 |          Returns vertex's id (int)
 |
 |      :Details:
 |
 |          When a scale different form Scale(v)-1 is specified using the optional parameter
 |          `Scale`, this scale must be lower than that of the vertex argument.
 |
 |      .. todo:: Complex(v, Scale=10) returns v why ? is this expected
 |
 |      .. seealso:: :func:`MTG`, :func:`Components`.
 |
 |  ComponentRoots(self, v, Scale=-1)
 |      Set of roots of the tree graphs that compose a vertex
 |
 |      In a MTG, a vertex may have be decomposed into components.
 |      Some of these components are connected to each other, while other are not.
 |      In the most general case, the components of a vertex are organized into several tree-graphs.
 |      This is for example the case of a MTG containing the description of several plants:
 |      the MTG root vertex can be decomposed into tree graphs (not connected)
 |      that represent the different plants.
 |      This function returns the set of roots of these tree graphs at scale *Scale(v)+1*.
 |      The order of these roots is not significant.
 |
 |      When a scale different from *Scale(v)+1* is specified using the optional argument :func:`Scale`,
 |      this scale must be greater than that of the vertex argument.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          g.ComponentRoots(v)
 |          g.ComponentRoots(v, Scale=s)
 |
 |      :Parameters:
 |
 |          - v (int) : vertex of the active MTG
 |
 |      :Optional Parameters:
 |
 |          - Scale (str): scale of the component roots.
 |
 |      :Returns:
 |
 |          list of vertices's id (int)
 |
 |
 |      :Examples:
 |
 |      .. code-block:: python
 |
 |          &gt;&gt;&gt; v=g.MTGRoot() # global MTG root
 |          0
 |          &gt;&gt;&gt; g.ComponentRoots(v) # set of first vertices at scale 1
 |          [1,34,76,100,199,255]
 |          &gt;&gt;&gt; g.ComponentRoots(v, Scale=2) # set of first vertices at scale 2
 |          [2,35,77,101,200,256]
 |
 |      .. image:: ../user/mtg_componentroots.png
 |
 |      .. seealso:: :func:`MTG`, :func:`Components`, :func:`Trunk`.
 |
 |  Components(self, v, Scale=-1)
 |      Set of components of a vertex.
 |
 |      The set of components of a vertex is returned as a list of vertices.
 |      If **s** defines the scale of **v**, components are defined at scale **s** + 1.
 |      The array is empty if the vertex has no components.
 |      The order of the components in the array is not significant.
 |
 |      When a scale is specified using optional argument :arg:Scale,
 |      it must be necessarily greater than the scale of the argument.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          Components(v)
 |          Components(v, Scale=2)
 |
 |      :Parameters:
 |
 |          - v (int) : vertex of the active MTG
 |
 |      :Optional Parameters:
 |
 |          - Scale (int) : scale of the components.
 |
 |      :Returns:
 |
 |          list of int
 |
 |      .. image:: ../user/mtg_components.png
 |
 |      .. seealso:: :func:`MTG`, :func:`Complex`.
 |
 |  Defined(self, vid)
 |      Test whether a given vertex belongs to the active MTG.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          Defined(v)
 |
 |      :Parameters:
 |
 |          - v (int) : vertex of the active MTG
 |
 |      :Returns:
 |
 |          True or False
 |
 |      .. seealso:: :func:`MTG`.
 |
 |  Descendants(self, v, EdgeType='*', RestrictedTo='NoRestriction', ContainedIn=None)
 |      Set of vertices in the branching system borne by a vertex.
 |
 |      This function returns the set of descendants of its argument as an array of vertices.
 |      The array thus consists of all the vertices, at the same scale as `v`,
 |      that belong to the branching system starting at `v`.
 |      The order of the vertices in the array is not significant.
 |
 |      .. note:: The argument always belongs to the set of its descendants.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          g.Descendants(v)
 |
 |      :Parameters:
 |
 |          - v (int) : vertex of the active MTG
 |
 |      :Optional Parameters:
 |
 |          - RestrictedTo (str): cf. `Father`
 |          - ContainedIn (int): cf. `Father`
 |          - EdgeType (str): cf. `Father`
 |
 |      :Returns:
 |
 |          list of int.
 |
 |
 |      :Examples:
 |
 |      .. code-block:: python
 |
 |          &gt;&gt;&gt; v
 |          78
 |          &gt;&gt;&gt; g.Sons(v) # set of sons of v
 |          [78,99,101]
 |          &gt;&gt;&gt; g.Descendants(v) # set of descendants of v
 |          [78,99,101,121,133,135,156,171,190]
 |
 |      .. image:: ../user/mtg_descendants.png
 |
 |      .. seealso:: :func:`MTG`, :func:`Ancestors`.
 |
 |  EdgeType(self, v1, v2)
 |      Type of connection between two vertices.
 |
 |      Returns the symbol of the type of connection between two vertices (either `&lt;` or `+`).
 |      If the vertices are not connected, None is returned.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          EdgeType(v1, v2)
 |
 |      :Parameters:
 |
 |          - v1 (int) : vertex of the active MTG
 |          - v2 (int) : vertex of the active MTG
 |
 |      :Returns:
 |
 |          '&lt;' (successor), '+' (branching) or `None`
 |
 |      .. image:: ../user/mtg_edgetype.png
 |
 |      .. seealso:: :func:`MTG`, :func:`Sons`, :func:`Father`.
 |
 |  Extremities(self, v, RestrictedTo='NoRestriction', ContainedIn=None)
 |      Set of vertices that are the extremities of the branching system
 |      born by a given vertex.
 |
 |      This function returns the extremities of the branching system defined by the argument
 |      as a list of vertices. These vertices have the same scale as `v` and their order in
 |      the list is not signifiant. The result is always a non empty array.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          Extremities(v)
 |
 |      :Properties:
 |
 |          -  v (int) : vertex of the active MTG
 |
 |      :Optional Parameters:
 |
 |          - RestrictedTo (str): cf. :func:`Father`
 |          - ContainedIn (int): cf. :func:`Father`
 |
 |      :Returns:
 |
 |          list of vertices's id (int)
 |
 |
 |      :Examples:
 |
 |      .. code-block:: python
 |
 |          &gt;&gt;&gt; g.Descendants(v)
 |          [3, 45, 47, 78, 102]
 |          &gt;&gt;&gt; g.Extremities(v)
 |          [47, 102]
 |
 |      .. seealso:: :func:`MTG`, :func:`Descendants`, :func:`Root`, :func:`MTGRoot`.
 |
 |  Father(self, v, EdgeType='*', RestrictedTo='NoRestriction', ContainedIn=None, Scale=-1)
 |      Topological father of a given vertex.
 |
 |      Returns the topological father of a given vertex. And `None` if the father does not exist.
 |      If the argument is not a valid vertex, `None` is returned.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          g.Father(v)
 |          g.Father(v, EdgeType='&lt;')
 |          g.Father(v, RestrictedTo='SameComplex')
 |          g.Father(v, ContainedIn=complex_id)
 |          g.Father(v, Scale=s)
 |
 |      :Parameters:
 |
 |          v (int) : vertex of the active MTG
 |
 |      :Optional Parameters:
 |
 |          If no optional argument is specified,  the function returns the topological father
 |          of the argument (vertex that bears or precedes to the vertex passed as an argument).
 |
 |          It may be usefull in some cases to consider that the function only applies to a
 |          subpart of the MTG (e.g. an axis).
 |
 |          The following options enables us to specify such restrictions:
 |
 |          - EdgeType (str) : filter on the type of edge that connect the vertex to its father.
 |
 |            Values can be '&lt;', '+', and '*'. Values '*' means both '&lt;' and '+'.
 |            Only the vertex connected with the specified type of edge will be considered.
 |
 |          - RestrictedTo (str) : filter defining a subpart of the MTG where the father
 |            must be considered. If the father is actually outside this subpart,
 |            the result is `None`. Possible subparts are defined using keywords in
 |            ['SameComplex', 'SameAxis', 'NoRestriction'].
 |
 |            For instance, if `RestrictedTo` is set to 'SameComplex', :func:`Father(v)` returns a
 |            defined vertex only if the father `f` of `v` existsin the MTG and if `v` and `f`
 |            have the same complex.
 |
 |          - ContainedIn (int) : filter defining a subpart of the MTG where the father
 |            must be considered. If the father is actually outside this subpart,
 |            the result is `None`.
 |
 |            In this case, the subpart of the MTG is made of the vertices
 |            that composed `composite_id` (at any scale).
 |
 |          - Scale (int) : the scale of the considered father. Returns the vertex from scale `s`
 |            which either bears and precedes the argument.
 |
 |            The scale `s` can be lower than the argument's (corresponding to a question such as
 |            'which axis bears the internode?') or greater
 |            (e.g. 'which internodes bears this annual shoot?').
 |
 |      :Returns:
 |
 |          the vertex id of the Father (int)
 |
 |      .. seealso:: :func:`MTG`, :func:`Defined`, :func:`Sons`, :func:`EdgeType`, :func:`Complex`, :func:`Components`.
 |
 |  Height(self, v1, v2=None)
 |      Number of components existing between two components in a tree graph.
 |
 |      The height of a vertex (`v2`) with respect to another vertex (`v1`)
 |      is the number of edges (of either type '+' or '&lt;') that must be crossed
 |      when going from `v1` to `v2` in the graph.
 |
 |      This is a non-negative integer. When the function has only one argument `v1`,
 |      the height of `v1` correspond to the height of `v1`with respect
 |      to the root of the branching system containing `v1`.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          Height(v1)
 |          Height(v1, v2)
 |
 |      :Parameters:
 |
 |          - v1 (int) : vertex of the active MTG
 |          - v2 (int) : vertex of the active MTG
 |
 |      :Returns:
 |
 |          int
 |
 |      .. note::
 |
 |          When the function takes two arguments, the order of the arguments is not important
 |          provided that one is an ancestor of the other. When the order is relevant, use
 |          function `AlgHeight`.
 |
 |      .. seealso:: :func:`MTG`, :func:`Order`, :func:`Rank`, :func:`EdgeType`, :func:`AlgHeight`, :func:`AlgHeight`, :func:`AlgOrder`.
 |
 |  Index = index(self, vid)
 |
 |  Label = label(self, vid)
 |
 |  Path(self, v1, v2)
 |      List of vertices defining the path between two vertices
 |
 |      This function returns the list of vertices defining the path
 |      between two vertices that are in an ancestor relationship.
 |      The vertex `v1` must be an ancestor of vertex `v2`.
 |      Otherwise, if both vertices are valid, then the empty array is returned
 |      and if at least one vertex is undefined, None is returned.
 |
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          g.Path(v1, v2)
 |
 |      :Parameters:
 |
 |          - `v1` (int) : vertex of the active MTG
 |          - `v2` (int) : vertex of the active MTG
 |
 |      :Returns:
 |
 |          list of vertices's id (int)
 |
 |
 |      :Examples:
 |
 |      .. code-block:: python
 |
 |          &gt;&gt;&gt; v # print the value of v
 |          78
 |          &gt;&gt;&gt; g.Ancestors(v)
 |          [78,45,32,10,4]
 |          &gt;&gt;&gt; g.Path(10,v)
 |          [10,32,45,78]
 |          &gt;&gt;&gt; g.Path(9,v) # 9 is not an ancestor of 78
 |          []
 |
 |      .. note:: `v1` can be equal to `v2`.
 |
 |      .. image:: ../user/mtg_path.png
 |
 |      .. seealso:: :func:`MTG`, :func:`Axis`, :func:`Ancestors`.
 |
 |  Predecessor(self, v, **kwds)
 |      Father of a vertex connected to it by a '&lt;' edge
 |
 |      This function is equivalent to Father(v, EdgeType-&gt; '&lt;').
 |      It thus returns the father (at the same scale) of the argument
 |      if it is located in the same botanical.
 |      If it does not exist, None is returned.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          Predecessor(v)
 |
 |      :Parameters:
 |
 |          - v (int) : vertex of the active MTG
 |
 |      :Optional Parameters:
 |
 |          - RestrictedTo (str): cf. `Father`
 |          - ContainedIn (int): cf. `Father`
 |
 |      :Returns:
 |
 |          return the vertex id (int)
 |
 |
 |      :Examples:
 |
 |      .. code-block:: python
 |
 |          &gt;&gt;&gt; Predecessor(v)
 |          7
 |          &gt;&gt;&gt; Father(v, EdgeType='+')
 |          &gt;&gt;&gt; Father(v, EdgeType-&gt; '&lt;')
 |          7
 |
 |      .. seealso:: :func:`MTG`, :func:`Father`, :func:`Successor`.
 |
 |  Rank(self, v1, v2=None)
 |      Rank of one vertex with respect to another one.
 |
 |      This function returns the number of consecutive '&lt;'-type edges between two components,
 |      at the same scale, and does not take into account the order of vertices v1 and v2.
 |      The result is a non negative integer.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          Rank(v1)
 |          Rank(v1, v2)
 |
 |      :Parameters:
 |
 |          - v1 (int) : vertex of the active MTG
 |          - v2 (int) : vertex of the active MTG
 |
 |      :Returns:
 |
 |          `int`
 |
 |          If v1 is not an ancestor of v2 (or vise versa) within the same botanical axis,
 |          or if v1 and v2 are not defined at the same scale, an error value Undef id returned.
 |
 |      .. seealso:: :func:`MTG`, :func:`Order`, :func:`Height`, :func:`EdgeType`, :func:`AlgRank`, :func:`AlgHeight`, :func:`AlgOrder`.
 |
 |  Root(self, v, RestrictedTo='*', ContainedIn=None)
 |      Root of the branching system containing a vertex
 |
 |      This function is equivalent to Ancestors(v, EdgeType='&lt;')[-1].
 |      It thus returns the root of the branching system containing the argument.
 |      This function never returns None.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          g.Root(v)
 |
 |      :Parameters:
 |
 |          - v (int) : vertex of the active MTG
 |
 |      :Optional Parameters:
 |
 |          - RestrictedTo (str): cf. Father
 |          - ContainedIn (int): cf. Father
 |
 |      :Returns:
 |
 |         return vertex's id (int)
 |
 |
 |      :Examples:
 |
 |      .. code-block:: python
 |
 |          &gt;&gt;&gt; g.Ancestors(v) # set of ancestors of v
 |          [102,78,35,33,24,12]
 |          &gt;&gt;&gt; g.Root(v) # root of the branching system containing v
 |          12
 |
 |      .. image:: ../user/mtg_root.png
 |
 |      .. seealso:: :func:`MTG`, :func:`Extremities`.
 |
 |  Scale = scale(self, vid)
 |
 |  Sons(self, v, RestrictedTo='NoRestriction', EdgeType='*', Scale=-1, ContainedIn=None)
 |      Set of vertices born or preceded by a vertex
 |
 |      The set of sons of a given vertex is returned as an array of vertices.
 |      The order of the vertices in the array is not significant.
 |      The array can be empty if there are no son vertices.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          g.Sons(v)
 |          g.Sons(v, EdgeType= '+')
 |          g.Sons(v, Scale= 3)
 |
 |      :Parameters:
 |
 |          - v (int) : vertex of the active MTG
 |
 |      :Optional Parameters:
 |
 |          - RestrictedTo (str) : cf. :meth:`Father`
 |          - ContainedIn (int) : cf. :meth:`Father`
 |          - EdgeType (str) : filter on the type of sons.
 |          - Scale (int) : set the scale at which sons are considered.
 |
 |      :Returns:
 |
 |          list(vid)
 |
 |      :Details:
 |
 |          When the option EdgeType is applied, the function returns the set of sons
 |          that are connected to the argument with the specified type of relation.
 |
 |      .. note:: `Sons(v, EdgeType= '&lt;')` is not equivalent to `Successor(v)`.
 |          The first function returns an array of vertices while the second function
 |          returns a vertex.
 |
 |          The returned vertices have the same scale as the argument.
 |          However, coarser or finer vertices can be obtained by specifying
 |          the optional argument `Scale` at which the sons are considered.
 |
 |
 |      :Examples:
 |
 |      .. code-block:: python
 |
 |          &gt;&gt;&gt; g.Sons(v)
 |          [3,45,47,78,102]
 |          &gt;&gt;&gt;  g.Sons(v, EdgeType= '+') # set of vertices borne by v
 |          [3,45,47,102]
 |          &gt;&gt;&gt;  g.Sons(v, EdgeType= '&lt;') # set of successors of v on the same axis
 |          [78]
 |
 |      .. seealso:: :func:`MTG`, :func:`Father`, :func:`Successor`, :func:`Descendants`.
 |
 |  Successor(self, v, RestrictedTo='NoRestriction', ContainedIn=None)
 |      Vertex that is connected to a given vertex by a '&lt;' edge type (i.e. in the same botanical axis).
 |
 |      This function is equivalent to Sons(v, EdgeType='&lt;')[0].
 |      It returns the vertex that is connected to a given vertex by a '&lt;' edge type
 |      (i.e. in the same botanical axis).
 |      If many such vertices exist, an arbitrary one is returned by the function.
 |      If no such vertex exists, None is returned.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          g.Successor(v)
 |
 |      :Parameters:
 |
 |          - v1 (int) : vertex of the active MTG
 |
 |      :Optional Parameters:
 |
 |          - RestrictedTo (str): cf. Father
 |          - ContainedIn (int): cf. Father
 |
 |      :Returns:
 |
 |          Returns vertex's id (int)
 |
 |
 |      :Examples:
 |
 |      .. code-block:: python
 |
 |          &gt;&gt;&gt; g.Sons(v)
 |          [3, 45, 47, 78, 102]
 |          &gt;&gt;&gt; g.Sons(v, EdgeType='+') # set of vertices borne by v
 |          [3, 45, 47, 102]
 |          &gt;&gt;&gt; g.Sons(v, EdgeType-&gt; '&lt;') # set of successors of v
 |          [78]
 |          &gt;&gt;&gt; g.Successor(v)
 |          78
 |
 |      .. seealso:: :func:`MTG`, :func:`Sons`, :func:`Predecessor`.
 |
 |  Trunk(self, v, Scale=-1)
 |      List of vertices constituting the bearing botanical axis of a branching system.
 |
 |      Trunk returns the list of vertices representing the botanical axis defined as
 |      the bearing axis of the whole branching system defined by `v`.
 |      The optional argument enables the user to choose the scale at which the trunk should be detailed.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          Trunk(v)
 |          Trunk(v, Scale= s)
 |
 |      :Parameters:
 |
 |          - `v` (int) : Vertex of the active MTG.
 |
 |      :Optional Parameters:
 |
 |          - `Scale` (str): scale at which the axis components are required.
 |
 |      :Returns:
 |
 |          list of vertices ids
 |
 |      .. todo:: check the usage of the optional argument Scale
 |
 |      .. seealso:: :func:`MTG`, :func:`Path`, :func:`Ancestors`, :func:`Axis`.
 |
 |  VtxList(self, Scale=-1)
 |      Array of vertices contained in a MTG
 |
 |      The set of all vertices in the :func:`MTG` is returned as an array.
 |      Vertices from all scales are returned if no option is used.
 |      The order of the elements in this array is not significant.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          &gt;&gt;&gt; VtxList()
 |          &gt;&gt;&gt; VtxList(Scale=2)
 |
 |      :Optional Parameters:
 |
 |          - `Scale` (int): used to select components at a particular scale.
 |
 |      :Returns:
 |
 |          - list of vid
 |
 |      :Background:
 |
 |          :func:`MTGs`
 |
 |      .. seealso:: :meth:`MTG`, :meth:`scale`, :meth:`Class`, :meth:`index`.
 |
 |  __contains__(self, vid)
 |      Container interface
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          if v in g:
 |              print v, " is in the mtg."
 |
 |  __getitem__(self, vtx_id)
 |      A simple getitem to extract relevant information on a vertex.
 |
 |  __init__(self, filename='', has_date=False)
 |      Create a new MTG object.
 |
 |      :Usage:
 |
 |          &gt;&gt;&gt; g = MTG()
 |          &gt;&gt;&gt; g = MTG('my_mtg.mtg')
 |
 |  __iter__(self)
 |      Iterable interface.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          for v in g:
 |              print g.class_name(v)
 |
 |  __str__(self)
 |      Return str(self).
 |
 |  add_child(self, parent, child=None, **properties)
 |      Add a child to a parent. Child is appended to the parent's child list.
 |
 |      :Parameters:
 |       - `parent` (int) - The parent identifier.
 |       - `child`  (int or None) - The child identifier. If None,
 |                  an ID is generated.
 |
 |      :Returns:
 |          Identifier of the inserted vertex (child)
 |      :Returns Type:
 |          int
 |
 |  add_child_and_complex(self, parent, child=None, complex=None, **properties)
 |      Add a child at the end of children that belong to an other complex.
 |
 |      :Parameters:
 |       - `parent`: The parent identifier.
 |       - `child`: Set the child identifier to this value if defined.
 |       - `complex`: Set the complex identifier to this value if defined.
 |      :returns: (vid, vid): child and complex ids.
 |
 |  add_component(self, complex_id, component_id=None, **properties)
 |      Add a component at the end of the components
 |
 |      :Parameters:
 |       - `complex_id`: The complex identifier.
 |       - `component_id`: Set the component identifier to this value if defined.
 |
 |      :Returns: The id of the new component or the component_id if given.
 |
 |  add_element(self, parent_id, edge_type='/', scale_id=None)
 |      Add an element to the graph, if vid is not provided create a new vid ???
 |      .. warning: Not Implemented.
 |
 |      :Parameters:
 |      - `parent_id` (int) - The id of the parent vertex
 |      - `edge_type` (str) - The type of relation:
 |          - "/" : component (default)
 |          - "+" : branch
 |          - "&lt;" : successor.
 |      - `scale_id` (int)  - The id of the scale in which to
 |          add the vertex.
 |
 |      :Returns:
 |          The vid of the created vertex
 |
 |  class_name(self, vid)
 |      Class of a vertex.
 |
 |      The Class of a vertex are the first characters of the label.
 |      The label of a vertex is the string defined by the concatenation
 |      of the class and its index.
 |
 |      The label thus provides general information about a vertex and
 |      enable to encode the plant components.
 |
 |      The class_name may be not defined. Then, an empty string is returned.
 |
 |      :Usage:
 |
 |          &gt;&gt;&gt; g.class_name(1)
 |
 |      :Parameters:
 |
 |          - `vid` (int)
 |
 |      :Returns:
 |          The class name of the vertex (str).
 |
 |      .. seealso:: :func:`MTG`, :func:`openalea.mtg.aml.Index`, :func:`openalea.mtg.aml.Class`
 |
 |  clear(self)
 |      Remove all vertices and edges from the MTG.
 |
 |      This also removes all vertex properties.
 |      Don't change references to object such as internal dictionaries.
 |
 |      :Example:
 |          .. code-block:: python
 |
 |              &gt;&gt;&gt; g.clear()
 |              &gt;&gt;&gt; g.nb_vertices()
 |              0
 |              &gt;&gt;&gt; len(g)
 |              0
 |
 |  clear_properties(self, exclude=[])
 |      Remove all the properties of the MTG.
 |
 |      :Example:
 |          .. code-block:: python
 |
 |              &gt;&gt;&gt; g.clear_properties()
 |
 |  complex(self, vtx_id)
 |      Returns the complex of `vtx_id`.
 |
 |      :Parameters:
 |       - `vtx_id` (int) - The vertex identifier.
 |
 |      :Returns:
 |          complex identifier or None if vtx_id has no parent.
 |      :Return Type:
 |          int
 |
 |  complex_at_scale(self, vtx_id, scale)
 |      Returns the complex of `vtx_id` at scale `scale`.
 |
 |      :Parameters:
 |       - `vtx_id`: The vertex identifier.
 |       - `scale`: The scale identifier.
 |
 |      :returns:
 |          vertex identifier
 |      :Returns Type:
 |          int
 |
 |  component_roots(self, vtx_id)
 |      Return the set of roots of the tree graphs that compose a vertex.
 |
 |  component_roots_at_scale(self, vtx_id, scale)
 |      Return the list of roots of the tree graphs that compose a vertex.
 |
 |  component_roots_at_scale_iter(self, vtx_id, scale)
 |      Return the set of roots of the tree graphs that compose a vertex.
 |
 |  component_roots_iter(self, vtx_id)
 |      Return an iterator of the roots of the tree graphs that compose a vertex.
 |
 |  components(self, vid)
 |      returns the components of a vertex
 |
 |      :param vid: The vertex identifier.
 |
 |      :returns: list of vertex identifier
 |
 |  components_at_scale(self, vid, scale)
 |      returns a vertex iterator
 |
 |      :Parameters:
 |       - `vid`: The vertex identifier.
 |
 |      :returns: iter of vertex identifier
 |
 |  components_at_scale_iter(self, vid, scale)
 |      returns a vertex iterator
 |
 |      :Parameters:
 |       - `vid`: The vertex identifier.
 |
 |      :returns: iter of vertex identifier
 |
 |  components_iter(self, vid)
 |      returns a vertex iterator
 |
 |      :param vid: The vertex identifier.
 |
 |      :returns: iter of vertex identifier
 |
 |  copy(self)
 |      Return a copy of the graph.
 |
 |      :Returns:
 |          - `g` (MTG) - A copy of the MTG
 |
 |  display(self, max_scale=0, display_id=True, display_scale=False, nb_tab=12, **kwds)
 |      Print an MTG on the console.
 |
 |      :Optional Parameters:
 |          - `max_scale`: do not print vertices of scale greater than max_scale
 |          - `display_id`: display the vid of the vertices
 |          - `display_scale`: display the scale of the vertices
 |          - `nb_tab`: display the MTG using nb_tab columns
 |
 |  edge_type(self, vid)
 |      Type of the edge between a vertex and its parent.
 |
 |      The different values are '&lt;' for successor, and '+' for ramification.
 |
 |  edges(self, scale=-1)
 |      :Parameters:
 |       - `scale` (int) - Scale at which to iterate.
 |      :Returns:
 |          Iterator on the edges of the MTG at a given scale
 |          or on all edges if scale &lt; 0.
 |      :Returns Type:
 |          iter
 |
 |  has_vertex(self, vid)
 |      Tests whether a vertex belongs to the graph.
 |
 |      :Parameters:
 |       - `vid` (int) - vertex id to test
 |      :Returns Type:
 |          bool
 |
 |  index(self, vid)
 |      Index of a vertex
 |
 |      The Index of a vertex is a feature always defined and independent of time
 |      (like the index).
 |      It is represented by a non negative integer.
 |      The label of a vertex is the string defined by the concatenation
 |      of its class and its index.
 |      The label thus provides general information about a vertex and
 |      enables us to encode the plant components.
 |
 |  insert_parent(self, vtx_id, parent_id=None, **properties)
 |      Insert parent_id between vtx_id and its actual parent.
 |      Inherit of the complex of the parent of vtx_id.
 |
 |      :Parameters:
 |       - `vtx_id` (int): a vertex identifier
 |       - `parent_id` (int): a vertex identifier
 |
 |      :Returns:
 |          Identifier of the inserted vertex (parent_id).
 |      :Returns Type:
 |          int
 |
 |  insert_scale(self, inf_scale=None, partition=None, default_label=None, preserve_order=True)
 |      Add a scale to MTG
 |
 |      :Parameters:
 |      - `inf_scale` (int) - New scale is inserted between inf_scale and inf_scale-1
 |      - `partition` (lambda v: bool) - Function defining new scale by quotienting vertices at inf_scale
 |      - `default_label` (str) - default label of inserted vertices
 |      - `preserve_order` (bool) - True iif children at new scale are ordered consistently
 |          with children at inf_scale
 |
 |      :Returns:
 |          MTG with inserted scale
 |
 |      :Remark:
 |          - New scale is inserted in self as well.
 |          - function partition should return True at roots of subtrees where partition changes
 |          and False elsewhere.
 |
 |  insert_sibling(self, vtx_id1, vtx_id2=None, **properties)
 |      Insert a sibling of vtk_id1. The vertex in inserted before vtx_id1.
 |
 |      :Parameters:
 |       - `vtx_id1` (int) : a vertex identifier
 |       - `vtx_id2` (int) : the vertex to insert
 |
 |      :Returns:
 |          Identifier of the inserted vertex (vtx_id2)
 |      :Returns Type:
 |          int
 |
 |  is_valid(self)
 |      Tests the validity of the graph. Currently
 |      always returns True.
 |
 |      :Returns Type:
 |          bool
 |      :todo: Implement this function.
 |
 |  iter_edges(self, scale=-1)
 |      :Parameters:
 |       - `scale` (int) - Scale at which to iterate.
 |      :Returns:
 |          Iterator on the edges of the MTG at a given scale
 |          or on all edges if scale &lt; 0.
 |      :Returns Type:
 |          iter
 |
 |  iteredges(self, scale=-1)
 |      Iter on the edges of the tree.
 |
 |  label(self, vid)
 |      Label of a vertex.
 |
 |      :Usage:
 |
 |          &gt;&gt;&gt; g.label(v)
 |
 |      :Parameters:
 |          - `vid` (int) : vertex of the MTG
 |
 |      :Returns:
 |          The class and Index of the vertex (str).
 |
 |      .. seealso:: :func:`MTG`, :func:`index`, :func:`class_name`
 |
 |  max_scale(self)
 |      Return the max scale identifier.
 |
 |      By convention, the mtg contains scales in :math:`[0,max\_scale]`.
 |
 |      :Usage:
 |          &gt;&gt;&gt; print g.max_scale()
 |
 |      :Returns:
 |          S, the maximum scale identifier.
 |
 |      .. note:: The complexity is :math:`O(n)`.
 |      .. seealso:: :func:`scale`, :func:`scales`
 |
 |  nb_components(self, vid)
 |      returns the number of components
 |
 |      :Parameters:
 |       - `vid`: The vertex identifier.
 |
 |      :returns: int
 |
 |  nb_scales(self)
 |      :Returns:
 |          The number of scales defined in the mtg..
 |      :Returns Type:
 |          int
 |
 |      .. note:: The complexity is :math:`O(n)`.
 |
 |  nb_vertices(self, scale=-1)
 |      Returns the number of vertices.
 |
 |      :Usage:
 |          &gt;&gt;&gt; g.nb_vertices()
 |          100
 |          &gt;&gt;&gt; g.nb_vertices(scale=3)
 |          68
 |
 |      :Parameters:
 |       - `scale` (int) - Id of scale for which to count
 |         vertices.
 |
 |      :Returns:
 |          Number of vertices at `scale` or total
 |          number of vertices if scale &lt; 0.
 |
 |  node(self, vid, klass=None)
 |      Return a node associated to the vertex `vid`.
 |
 |      It allows to access to the properties with an object oriented interface.
 |
 |      :Example:
 |
 |      .. code-block:: python
 |
 |          node = g.node(1)
 |          print node.edge_type
 |          print node.label
 |          node.label = 'B'
 |          print g.label(1)
 |
 |          print node.parent
 |          print list(node.children)
 |
 |  order(self, v1)
 |      Order of a vertex in a graph.
 |
 |      The order of a vertex in a graph is the number of '+' edges crossed
 |      when going from `v1`to `v2`.
 |
 |      If v2 is None, the order of v1 correspond to the order of v1 with
 |      respect to the root.
 |
 |  plot_property(self, prop, **kwds)
 |      Plot properties of MTG using matplotlib
 |
 |      :Example:
 |
 |          &gt;&gt;&gt; g.plot_property('length')
 |
 |  reindex(self, mapping=None, copy=False)
 |      Assign a new identifier to each vertex.
 |
 |      This method assigns a new identifier to each vertex of the MTG. The mapping can be user defined or
 |      is implicit (`mapping`). This method modify the MTG in place or return a new MTG (`copy`).
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          &gt;&gt;&gt; g.reindex()
 |          &gt;&gt;&gt; g1 = g.reindex(copy=True)
 |          &gt;&gt;&gt; mymap = dict(zip(list(traversal.iter_mtg2(g,g.root)), range(len(g))))
 |          &gt;&gt;&gt; g2 = g.reindex(mapping=mymap, copy=True)
 |
 |      :Optional Parameters:
 |
 |          - `mapping` (dict): define a mapping between old and new vertex identifiers.
 |          - `copy` (bool) : modify the object in place or return a new MTG.
 |
 |      :Returns:
 |
 |          - a MTG
 |
 |      :Background:
 |
 |          :func:`MTGs`
 |
 |      .. seealso:: :meth:`sub_mtg`
 |
 |  remove_scale(self, scale)
 |      Remove all the vertices at a given scale.
 |
 |      The upper and lower scale are then connected.
 |
 |      Parameters:
 |      ===========
 |          - scale : the scale that have to be removed
 |
 |      Returns
 |      =======
 |          - g : the input MTG modified in place.
 |          - results : a list of dict
 |              all the vertices that have been removed
 |
 |  remove_vertex(self, vid, reparent_child=False)
 |      Remove a specified vertex of the graph and
 |      remove all the edges attached to it.
 |
 |      :Parameters:
 |          - `vid` (int) : the id of the vertex to remove
 |          - `reparent_child` (bool) : reparent the children of `vid` to its parent.
 |      :Returns: None
 |
 |  replace_parent(self, vtx_id, new_parent_id, **properties)
 |      Change the parent of vtx_id to new_parent_id.
 |      The new parent of vtx_id is new_parent_id.
 |      vtx_id and new_parent_id must have the same scale.
 |
 |      This function do not change the edge_type between vtx_id and its parent.
 |
 |      Inherit of the complex of the parent of vtx_id.
 |
 |      :Parameters:
 |       - `vtx_id` (int): a vertex identifier
 |       - `new_parent_id` (int): a vertex identifier
 |
 |      :Returns:
 |          None
 |
 |  roots(self, scale=0)
 |      Returns a list of the roots of the tree graphs at a given scale.
 |
 |      In an MTG, the MTG root vertex, namely the vertex `g.root`,
 |      can be decomposed into several, non-connected, tree graphs at a given scale.
 |      This is for example the case of an MTG containing the description of several plants.
 |
 |      :Usage: ::
 |
 |          roots = g.roots(scale=g.max_scale()
 |
 |      :Returns:
 |          list on vertex identifiers of root vertices at a given `scale`.
 |      :Returns Type:
 |          list of vid
 |
 |      .. image:: ../user/mtg_componentroots.png
 |
 |  roots_iter(self, scale=0)
 |      Returns an iterator of the roots of the tree graphs at a given scale.
 |
 |      In an MTG, the MTG root vertex, namely the vertex `g.root`,
 |      can be decomposed into several, non-connected, tree graphs at a given scale.
 |      This is for example the case of an MTG containing the description of several plants.
 |
 |      :Usage: ::
 |
 |          roots = list(g.roots(scale=g.max_scale())
 |
 |      :Returns:
 |          iterator on vertex identifiers of root vertices at a given `scale`.
 |      :Returns Type:
 |          iter
 |
 |      .. image:: ../user/mtg_componentroots.png
 |
 |  scale(self, vid)
 |      Returns the scale of a vertex.
 |
 |      All vertices should belong to a given scale.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          g.scale(vid)
 |
 |      :Parameters:
 |
 |          - `vid` (int) - vertex identifier.
 |
 |      :Returns:
 |          The scale of the vertex.
 |          It is a positive int in [0,g.max_scale()].
 |
 |  scales(self)
 |      Return the different scales of the mtg.
 |
 |      :Returns:
 |          Iterator on scale identifiers (ints).
 |
 |      .. note:: The complexity is :math:`O(n)`.
 |
 |  scales_iter(self)
 |      Return the different scales of the mtg.
 |
 |      :Returns:
 |          Iterator on scale identifiers (ints).
 |
 |      .. note:: The complexity is :math:`O(n)`.
 |
 |  sub_mtg(self, vtx_id, copy=True)
 |      Return the submtg rooted on `vtx_id`.
 |
 |      The induced sub mtg of the mtg are all the vertices which have vtx_id
 |      has a complex plus vtx_id.
 |
 |      :Parameters:
 |        - `vtx_id`: A vertex of the original tree.
 |        - `copy`:
 |          If True, return a new tree holding the subtree. If False, the subtree is
 |          created using the original tree by deleting all vertices not in the subtree.
 |
 |      :returns: A sub mtg of the mtg. If copy=True, a new MTG is returned.
 |          Else the sub mtg is created inplace by modifying the original tree.
 |
 |  vertices(self, scale=-1)
 |      Return a list of the vertices contained in an MTG.
 |
 |      The set of all vertices in the MTG is returned.
 |      Vertices from all scales are returned if no scale is given.
 |      Otherwise, it returns only the vertices of the given scale.
 |      The order of the elements in this array is not significant.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          g = MTG()
 |          len(g) == len(list(g.vertices()))
 |          for vid in g.vertices(scale=2):
 |              print g.class_name(vid)
 |
 |      :Optional Parameters:
 |          - `scale` (int): used to select vertices at a given scale.
 |
 |      :Returns:
 |          Iterator on vertices at "scale" or on all
 |          vertices if scale &lt; 0.
 |
 |      :Returns Type:
 |          list of vid
 |
 |      :Background:
 |
 |      .. seealso:: :meth:`children`, :meth:`components`, :meth:`vertices_iter`..
 |
 |  vertices_iter(self, scale=-1)
 |      Return an iterator of the vertices contained in an MTG.
 |
 |      The set of all vertices in the MTG is returned.
 |      Vertices from all scales are returned if no scale is given.
 |      Otherwise, it returns only the vertices of the given scale.
 |      The order of the elements in this array is not significant.
 |
 |      :Usage:
 |
 |      .. code-block:: python
 |
 |          g = MTG()
 |          len(g) == len(list(g.vertices()))
 |          for vid in g.vertices(scale=2):
 |              print g.class_name(vid)
 |
 |      :Optional Parameters:
 |          - `scale` (int): used to select vertices at a given scale.
 |
 |      :Returns:
 |          Iterator on vertices at "scale" or on all
 |          vertices if scale &lt; 0.
 |
 |      :Returns Type:
 |          iter of vid
 |
 |      :Background:
 |
 |      .. seealso:: :meth:`children`, :meth:`components`.
 |
 |  ----------------------------------------------------------------------
 |  Methods inherited from openalea.mtg.tree.PropertyTree:
 |
 |  add_child_tree(self, parent, tree)
 |      Add a tree after the children of the parent vertex.
 |      Complexity have to be O(1) if tree == sub_tree()
 |
 |      :param parent: vertex identifier
 |      :param tree: a rooted tree
 |
 |  add_property(self, property_name)
 |      Add a new map between vid and a data
 |      Do not fill this property for any vertex
 |
 |  get_vertex_property(self, vid)
 |      Returns all the properties defined on a vertex.
 |
 |  graph_properties(self)
 |      return a dict containing the graph properties/
 |
 |      :rtype: dict of ``{property_name:data}``
 |
 |  insert_sibling_tree(self, vid, tree)
 |      Insert a tree before the vid.
 |      vid and the root of the tree are siblings.
 |      Complexity have to be O(1) if tree comes from the actual tree
 |      ( tree= self.sub_tree() )
 |
 |      :param vid: vertex identifier
 |      :param tree: a rooted tree
 |
 |  properties(self)
 |      Returns all the property maps contain in the graph.
 |
 |  property(self, name)
 |      Returns the property map between the vid and the data.
 |      :returns:  dict of {vid:data}
 |
 |  property_names(self)
 |      names of all property maps.
 |      Properties are defined only on vertices, even edge properties.
 |      return iter of names
 |
 |  property_names_iter(self)
 |      iter on names of all property maps.
 |      Properties are defined only on vertices, even edge properties.
 |      return iter of names
 |
 |  remove_property(self, property_name)
 |      Remove the property map called property_name from the graph.
 |
 |  remove_tree(self, vtx_id)
 |      Remove the sub tree rooted on `vtx_id`.
 |
 |      :returns: bool
 |
 |  sub_tree(self, vtx_id, copy=True)
 |      Return the subtree rooted on `vtx_id`.
 |
 |      The induced subtree of the tree has the vertices in the ancestors of vtx_id.
 |
 |      :Parameters:
 |        - `vtx_id`: A vertex of the original tree.
 |        - `copy`:
 |          If True, return a new tree holding the subtree. If False, the subtree is
 |          created using the original tree by deleting all vertices not in the subtree.
 |
 |      :returns: A sub tree of the tree. If copy=True, a new Tree is returned.
 |          Else the subtree is created inplace by modifying the original tree.
 |
 |  ----------------------------------------------------------------------
 |  Methods inherited from openalea.mtg.tree.Tree:
 |
 |  __len__(self)
 |
 |  children(self, vtx_id)
 |      returns a vertex iterator
 |
 |      :param vtx_id: The vertex identifier.
 |
 |      :returns: iter of vertex identifier
 |
 |  children_iter(self, vtx_id)
 |      returns a vertex iterator
 |
 |      :param vtx_id: The vertex identifier.
 |
 |      :returns: iter of vertex identifier
 |
 |  get_root(self)
 |      Return the tree root.
 |
 |      :return: vertex identifier
 |
 |  is_leaf(self, vtx_id)
 |      Test if `vtx_id` is a leaf.
 |
 |      :returns: bool
 |
 |  nb_children(self, vtx_id)
 |      returns the number of children
 |
 |      :Parameters:
 |       - `vtx_id`: The vertex identifier.
 |
 |      :returns: int
 |
 |  nb_siblings(self, vtx_id)
 |      returns the number of siblings
 |
 |      :returns: int
 |
 |  parent(self, vtx_id)
 |      Return the parent of `vtx_id`.
 |
 |      :Parameters:
 |       - `vtx_id`: The vertex identifier.
 |
 |      :returns: vertex identifier
 |
 |  set_root(self, vtx_id)
 |      Set the tree root.
 |
 |      :param vtx_id: The vertex identifier.
 |
 |  siblings(self, vtx_id)
 |      returns an iterator of vtx_id siblings.
 |      vtx_id is not include in siblings.
 |
 |      :Parameters:
 |       - `vtx_id`: The vertex identifier.
 |
 |      :returns: iter of vertex identifier
 |
 |  siblings_iter(self, vtx_id)
 |      returns an iterator of vtx_id siblings.
 |      vtx_id is not include in siblings.
 |
 |      :Parameters:
 |       - `vtx_id`: The vertex identifier.
 |
 |      :returns: iter of vertex identifier
 |
 |  ----------------------------------------------------------------------
 |  Data descriptors inherited from openalea.mtg.tree.Tree:
 |
 |  __dict__
 |      dictionary for instance variables
 |
 |  __weakref__
 |      list of weak references to the object
 |
 |  root
 |      Return the tree root.
 |
 |      :return: vertex identifier
</code></pre>
</div>
</div>
<div id="cell-33" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>g.vertices()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>[0,
 1,
 2,
 3,
 4,
 5,
 6,
 7,
 8,
 9,
 10,
 11,
 12,
 13,
 14,
 15,
 16,
 17,
 18,
 19,
 20,
 21,
 22,
 23,
 24,
 25,
 26,
 27,
 28,
 29,
 30,
 31,
 32,
 33,
 34,
 35,
 36,
 37,
 38,
 39,
 40,
 41,
 42,
 43,
 44,
 45,
 46]</code></pre>
</div>
</div>
<div id="cell-34" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">id</span> <span class="kw">in</span> g.vertices():</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(g[<span class="bu">id</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{'vid': 0, 'index': 0, 'complex': None, 'parent': None, 'scale': 0}
{'edge_type': '/', 'label': 'Plant', 'vid': 1, 'index': 1, 'complex': 0, 'parent': None, 'scale': 1}
{'edge_type': '/', 'label': 'MainAxis', 'vid': 2, 'index': 2, 'complex': 1, 'parent': None, 'scale': 2}
{'label': 'Stem', 'mature_length': 2.0, 'length': 2.0, 'visible_length': 2.0, 'is_green': True, 'diameter': 2.5, 'azimuth': 0.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3DBD0&gt;, 'anchor_point': Vector3(0,0,0), 'vid': 3, 'index': 3, 'complex': 2, 'parent': None, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 0.9511930974888486, 'visible_length': 0.9511930974888486, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 0.9511930974888486, 'leaf_area': 0.08142914778393873, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 0.11414317169866182, 'stem_diameter': 2.5, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3DCB0&gt;, 'anchor_point': Vector3(0,0,2), 'vid': 4, 'index': 4, 'complex': 2, 'parent': 3, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 2.0, 'length': 2.0, 'visible_length': 2.0, 'is_green': True, 'diameter': 2.5, 'azimuth': 180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3DE00&gt;, 'anchor_point': Vector3(0,0,2), 'vid': 5, 'index': 5, 'complex': 2, 'parent': 3, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 1.9059330852612248, 'visible_length': 1.9059330852612248, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 1.9059330852612248, 'leaf_area': 0.32693228329440344, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 0.22871197023134698, 'stem_diameter': 2.5, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3DE70&gt;, 'anchor_point': Vector3(0,0,4), 'vid': 6, 'index': 6, 'complex': 2, 'parent': 5, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 2.0, 'length': 2.0, 'visible_length': 2.0, 'is_green': True, 'diameter': 2.5, 'azimuth': -180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3DEE0&gt;, 'anchor_point': Vector3(0,0,4), 'vid': 7, 'index': 7, 'complex': 2, 'parent': 5, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 4.203195281771148, 'visible_length': 4.203195281771148, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 4.203195281771148, 'leaf_area': 1.5900165519032914, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 0.5043834338125377, 'stem_diameter': 2.5, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3DF50&gt;, 'anchor_point': Vector3(0,0,6), 'vid': 8, 'index': 8, 'complex': 2, 'parent': 7, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 2.0, 'length': 2.0, 'visible_length': 2.0, 'is_green': True, 'diameter': 2.5, 'azimuth': 180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3DFC0&gt;, 'anchor_point': Vector3(0,0,6), 'vid': 9, 'index': 9, 'complex': 2, 'parent': 7, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 8.83557884827753, 'visible_length': 8.83557884827753, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 8.83557884827753, 'leaf_area': 7.0260708225716355, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 1.0602694617933035, 'stem_diameter': 2.5, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E030&gt;, 'anchor_point': Vector3(0,0,8), 'vid': 10, 'index': 10, 'complex': 2, 'parent': 9, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 2.0, 'length': 2.0, 'visible_length': 2.0, 'is_green': True, 'diameter': 2.5, 'azimuth': -180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E0A0&gt;, 'anchor_point': Vector3(0,0,8), 'vid': 11, 'index': 11, 'complex': 2, 'parent': 9, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 15.332907866380747, 'visible_length': 15.332907866380747, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 15.332907866380747, 'leaf_area': 21.15882572750285, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 1.8399489439656895, 'stem_diameter': 2.5, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E180&gt;, 'anchor_point': Vector3(0,0,10), 'vid': 12, 'index': 12, 'complex': 2, 'parent': 11, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 2.352941176470587, 'length': 2.352941176470587, 'visible_length': 2.352941176470587, 'is_green': True, 'diameter': 2.5, 'azimuth': 180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E110&gt;, 'anchor_point': Vector3(0,0,10), 'vid': 13, 'index': 13, 'complex': 2, 'parent': 11, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 19.02386194977697, 'visible_length': 19.02386194977697, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 19.02386194977697, 'leaf_area': 32.57165911357548, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 2.2828634339732363, 'stem_diameter': 2.5, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E1F0&gt;, 'anchor_point': Vector3(0,0,12.3529), 'vid': 14, 'index': 14, 'complex': 2, 'parent': 13, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 12.352941176470587, 'length': 12.352941176470587, 'visible_length': 12.352941176470587, 'is_green': True, 'diameter': 2.375, 'azimuth': -180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E2D0&gt;, 'anchor_point': Vector3(0,0,12.3529), 'vid': 15, 'index': 15, 'complex': 2, 'parent': 13, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 23.967297224216356, 'visible_length': 23.967297224216356, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 23.967297224216356, 'leaf_area': 51.69882026105361, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 2.8760756669059626, 'stem_diameter': 2.375, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E340&gt;, 'anchor_point': Vector3(0,0,24.7059), 'vid': 16, 'index': 16, 'complex': 2, 'parent': 15, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 12.352941176470594, 'length': 12.352941176470594, 'visible_length': 12.352941176470594, 'is_green': True, 'diameter': 2.25, 'azimuth': 180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E260&gt;, 'anchor_point': Vector3(0,0,24.7059), 'vid': 17, 'index': 17, 'complex': 2, 'parent': 15, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 29.981386234328838, 'visible_length': 29.981386234328838, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 29.981386234328838, 'leaf_area': 80.89951684788024, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 3.5977663481194604, 'stem_diameter': 2.25, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E3B0&gt;, 'anchor_point': Vector3(0,0,37.0588), 'vid': 18, 'index': 18, 'complex': 2, 'parent': 17, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 12.35294117647058, 'length': 12.35294117647058, 'visible_length': 12.35294117647058, 'is_green': True, 'diameter': 2.125, 'azimuth': -180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E420&gt;, 'anchor_point': Vector3(0,0,37.0588), 'vid': 19, 'index': 19, 'complex': 2, 'parent': 17, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 37.102890598360794, 'visible_length': 37.102890598360794, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 37.102890598360794, 'leaf_area': 123.89620416785367, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 4.452346871803295, 'stem_diameter': 2.125, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E490&gt;, 'anchor_point': Vector3(0,0,49.4118), 'vid': 20, 'index': 20, 'complex': 2, 'parent': 19, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 12.352941176470594, 'length': 12.352941176470594, 'visible_length': 12.352941176470594, 'is_green': True, 'diameter': 2.0, 'azimuth': 180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E500&gt;, 'anchor_point': Vector3(0,0,49.4118), 'vid': 21, 'index': 21, 'complex': 2, 'parent': 19, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 45.25830541217596, 'visible_length': 45.25830541217596, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 45.25830541217596, 'leaf_area': 184.3482787903616, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 5.430996649461115, 'stem_diameter': 2.0, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E5E0&gt;, 'anchor_point': Vector3(0,0,61.7647), 'vid': 22, 'index': 22, 'complex': 2, 'parent': 21, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 12.352941176470594, 'length': 12.352941176470594, 'visible_length': 12.352941176470594, 'is_green': True, 'diameter': 1.875, 'azimuth': -180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E650&gt;, 'anchor_point': Vector3(0,0,61.7647), 'vid': 23, 'index': 23, 'complex': 2, 'parent': 21, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 54.21687176025305, 'visible_length': 54.21687176025305, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 54.21687176025305, 'leaf_area': 264.5522265120952, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 6.506024611230366, 'stem_diameter': 1.875, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E570&gt;, 'anchor_point': Vector3(0,0,74.1176), 'vid': 24, 'index': 24, 'complex': 2, 'parent': 23, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 12.35294117647058, 'length': 12.35294117647058, 'visible_length': 12.35294117647058, 'is_green': True, 'diameter': 1.75, 'azimuth': 180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E6C0&gt;, 'anchor_point': Vector3(0,0,74.1176), 'vid': 25, 'index': 25, 'complex': 2, 'parent': 23, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 63.55172805490181, 'visible_length': 63.55172805490181, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 63.55172805490181, 'leaf_area': 363.4939924887774, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 7.626207366588217, 'stem_diameter': 1.75, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E730&gt;, 'anchor_point': Vector3(0,0,86.4706), 'vid': 26, 'index': 26, 'complex': 2, 'parent': 25, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 12.35294117647058, 'length': 12.35294117647058, 'visible_length': 12.35294117647058, 'is_green': True, 'diameter': 1.625, 'azimuth': -180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E7A0&gt;, 'anchor_point': Vector3(0,0,86.4706), 'vid': 27, 'index': 27, 'complex': 2, 'parent': 25, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 72.62533208163514, 'visible_length': 72.62533208163514, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 72.62533208163514, 'leaf_area': 474.6994973971004, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 8.715039849796216, 'stem_diameter': 1.625, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E810&gt;, 'anchor_point': Vector3(0,0,98.8235), 'vid': 28, 'index': 28, 'complex': 2, 'parent': 27, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 12.352941176470608, 'length': 12.352941176470608, 'visible_length': 12.352941176470608, 'is_green': True, 'diameter': 1.5, 'azimuth': 180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E880&gt;, 'anchor_point': Vector3(0,0,98.8235), 'vid': 29, 'index': 29, 'complex': 2, 'parent': 27, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 80.61723053443279, 'visible_length': 80.61723053443279, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 80.61723053443279, 'leaf_area': 584.9224073137694, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 9.674067664131934, 'stem_diameter': 1.5, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E8F0&gt;, 'anchor_point': Vector3(0,0,111.176), 'vid': 30, 'index': 30, 'complex': 2, 'parent': 29, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 12.35294117647058, 'length': 12.35294117647058, 'visible_length': 12.35294117647058, 'is_green': True, 'diameter': 1.375, 'azimuth': -180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E960&gt;, 'anchor_point': Vector3(0,0,111.176), 'vid': 31, 'index': 31, 'complex': 2, 'parent': 29, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 86.60794057547501, 'visible_length': 86.60794057547501, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 86.60794057547501, 'leaf_area': 675.084183365251, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 10.392952869057002, 'stem_diameter': 1.375, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3E9D0&gt;, 'anchor_point': Vector3(0,0,123.529), 'vid': 32, 'index': 32, 'complex': 2, 'parent': 31, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 12.35294117647058, 'length': 12.35294117647058, 'visible_length': 12.35294117647058, 'is_green': True, 'diameter': 1.25, 'azimuth': 180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3EA40&gt;, 'anchor_point': Vector3(0,0,123.529), 'vid': 33, 'index': 33, 'complex': 2, 'parent': 31, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 89.71989570308179, 'visible_length': 89.71989570308179, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 89.71989570308179, 'leaf_area': 724.4693716474686, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 10.766387484369814, 'stem_diameter': 1.25, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3EAB0&gt;, 'anchor_point': Vector3(0,0,135.882), 'vid': 34, 'index': 34, 'complex': 2, 'parent': 33, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 12.352941176470608, 'length': 12.352941176470608, 'visible_length': 12.352941176470608, 'is_green': True, 'diameter': 1.125, 'azimuth': -180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3EB20&gt;, 'anchor_point': Vector3(0,0,135.882), 'vid': 35, 'index': 35, 'complex': 2, 'parent': 33, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 89.29602709763027, 'visible_length': 89.29602709763027, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 89.29602709763027, 'leaf_area': 717.6402409878648, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 10.715523251715632, 'stem_diameter': 1.125, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3EB90&gt;, 'anchor_point': Vector3(0,0,148.235), 'vid': 36, 'index': 36, 'complex': 2, 'parent': 35, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 12.35294117647058, 'length': 12.35294117647058, 'visible_length': 12.35294117647058, 'is_green': True, 'diameter': 1.0, 'azimuth': 180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3EC00&gt;, 'anchor_point': Vector3(0,0,148.235), 'vid': 37, 'index': 37, 'complex': 2, 'parent': 35, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 85.07441274901828, 'visible_length': 85.07441274901828, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 85.07441274901828, 'leaf_area': 651.3890134131291, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 10.208929529882193, 'stem_diameter': 1.0, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3EC70&gt;, 'anchor_point': Vector3(0,0,160.588), 'vid': 38, 'index': 38, 'complex': 2, 'parent': 37, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 12.35294117647058, 'length': 12.35294117647058, 'visible_length': 12.35294117647058, 'is_green': True, 'diameter': 0.875, 'azimuth': -180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3ECE0&gt;, 'anchor_point': Vector3(0,0,160.588), 'vid': 39, 'index': 39, 'complex': 2, 'parent': 37, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 77.30371162173756, 'visible_length': 77.30371162173756, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 77.30371162173756, 'leaf_area': 537.8277447447086, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 9.276445394608507, 'stem_diameter': 0.875, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3ED50&gt;, 'anchor_point': Vector3(0,0,172.941), 'vid': 40, 'index': 40, 'complex': 2, 'parent': 39, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 12.352941176470608, 'length': 12.352941176470608, 'visible_length': 12.352941176470608, 'is_green': True, 'diameter': 0.75, 'azimuth': 180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3EDC0&gt;, 'anchor_point': Vector3(0,0,172.941), 'vid': 41, 'index': 41, 'complex': 2, 'parent': 39, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 66.74940731793457, 'visible_length': 66.74940731793457, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 66.74940731793457, 'leaf_area': 400.9935039565983, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 8.009928878152149, 'stem_diameter': 0.75, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3EE30&gt;, 'anchor_point': Vector3(0,0,185.294), 'vid': 42, 'index': 42, 'complex': 2, 'parent': 41, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 12.352941176470551, 'length': 12.352941176470551, 'visible_length': 12.352941176470551, 'is_green': True, 'diameter': 0.625, 'azimuth': -180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3EEA0&gt;, 'anchor_point': Vector3(0,0,185.294), 'vid': 43, 'index': 43, 'complex': 2, 'parent': 41, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 54.569663998970206, 'visible_length': 54.569663998970206, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 54.569663998970206, 'leaf_area': 268.0063406064454, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 6.548359679876424, 'stem_diameter': 0.625, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3EF10&gt;, 'anchor_point': Vector3(0,0,197.647), 'vid': 44, 'index': 44, 'complex': 2, 'parent': 43, 'scale': 3}
{'edge_type': '&lt;', 'label': 'Stem', 'mature_length': 12.352941176470608, 'length': 12.352941176470608, 'visible_length': 12.352941176470608, 'is_green': True, 'diameter': 0.5, 'azimuth': 180.0, 'grow': False, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3EF80&gt;, 'anchor_point': Vector3(0,0,197.647), 'vid': 45, 'index': 45, 'complex': 2, 'parent': 43, 'scale': 3}
{'edge_type': '+', 'label': 'Leaf', 'length': 42.08458621271703, 'visible_length': 42.08458621271703, 'is_green': True, 'grow': False, 'shape': (array([0.00990483, 0.05135215, 0.08490658, 0.12522582, 0.18718874,
       0.30925598, 0.37238227, 0.45952663, 0.55145862, 0.58912238,
       0.64113653, 0.65280337]), array([-0.01843473,  0.11349698,  0.16756582,  0.21338825,  0.26124868,
        0.30703271,  0.3110246 ,  0.29390919,  0.23653963,  0.19223625,
        0.07121084, -0.00598376]), array([0.        , 0.13828904, 0.20192345, 0.26295899, 0.34125346,
       0.47162442, 0.53487681, 0.62368603, 0.73205003, 0.79019939,
       0.92192873, 1.        ]), array([0.73850144, 0.91417664, 0.96530623, 0.99465506, 1.00493343,
       0.96274111, 0.91950704, 0.82854785, 0.65356785, 0.53220181,
       0.23021259, 0.        ])), 'shape_mature_length': 42.08458621271703, 'leaf_area': 159.40011570260506, 'form_factor': 0.75, 'srb': 0, 'srt': 1, 'lrolled': 0, 'd_rolled': 0, 'shape_max_width': 5.050150345526043, 'stem_diameter': 0.5, 'geometry': &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet object at 0x0000023C77D3EFF0&gt;, 'anchor_point': Vector3(0,0,210), 'vid': 46, 'index': 46, 'complex': 2, 'parent': 45, 'scale': 3}</code></pre>
</div>
</div>
<p>Let’s dig into the propreties of the MTG of a cereal shoot.</p>
<div id="cell-36" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Imports</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># from installed packages</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> oawidgets.mtg <span class="im">import</span> <span class="op">*</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">## Code for exploring the MTG of the generated cereal shoot</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Properties on the MTG: this exclude all the topological properties</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(g_single.property_names())</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve one property for the MTG (dict)</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> g_single.<span class="bu">property</span>(<span class="st">'label'</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># print(labels)</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>i_length <span class="op">=</span> g_single.<span class="bu">property</span>(<span class="st">'mature_length'</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>l_length <span class="op">=</span> g_single.<span class="bu">property</span>(<span class="st">'shape_mature_length'</span>)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>leaf_lengths<span class="op">=</span>[]</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>leaf_ind<span class="op">=</span>[]</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>internode_lengths<span class="op">=</span>[]</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>internode_ind<span class="op">=</span>[]</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k,v <span class="kw">in</span> i_length.items():</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    internode_ind.append(k)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    internode_lengths.append(v)</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k,v <span class="kw">in</span> l_length.items():</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    leaf_ind.append(k)</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    leaf_lengths.append(v)</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>plt.plot(leaf_ind, leaf_lengths, c<span class="op">=</span><span class="st">"green"</span>, label<span class="op">=</span><span class="st">"Leaf lengths"</span>) <span class="co"># == 'shape_mature_length' for final plant</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>plt.plot(internode_ind, internode_lengths, c<span class="op">=</span><span class="st">"orange"</span>, label<span class="op">=</span><span class="st">"Internode lengths"</span>)</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>plt.plot(internode_ind, np.cumsum(internode_lengths), c<span class="op">=</span><span class="st">"orange"</span>, label<span class="op">=</span><span class="st">"Plant height"</span>, ls<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Vertices"</span>)</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Lengths (cm)"</span>)</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"MTG properties"</span>)</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg ansi-bold">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg ansi-bold">In[15], line 10</span>
<span class="ansi-green-fg">      4</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">oawidgets</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">mtg</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> <span style="color:rgb(98,98,98)">*</span>
<span class="ansi-green-fg">      7</span> <span style="font-style:italic;color:rgb(95,135,135)">## Code for exploring the MTG of the generated cereal shoot</span>
<span class="ansi-green-fg">      8</span> 
<span class="ansi-green-fg">      9</span> <span style="font-style:italic;color:rgb(95,135,135)"># Properties on the MTG: this exclude all the topological properties</span>
<span class="ansi-green-fg ansi-bold">---&gt; 10</span> <span style="color:rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">g_single</span><span style="color:rgb(98,98,98)">.</span>property_names())
<span class="ansi-green-fg">     12</span> <span style="font-style:italic;color:rgb(95,135,135)"># Retrieve one property for the MTG (dict)</span>
<span class="ansi-green-fg">     14</span> labels <span style="color:rgb(98,98,98)">=</span> g_single<span style="color:rgb(98,98,98)">.</span>property(<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">label</span><span style="color:rgb(175,0,0)">'</span>)

<span class="ansi-red-fg ansi-bold">NameError</span>: name 'g_single' is not defined</pre>
</div>
</div>
</div>
<p>The leaf lengths and widths follow the bell shaped curve described before.<br>
The first internode in the MTG actually corresponds to the pseudostem, i.e.&nbsp;the about 4 to 8 short first internodes that rapidly lose their leaves. The lengths following internodes follow the geometric model described before.</p>
<div id="cell-38" class="cell" data-scrolled="true" data-execution_count="22">
<div class="cell-output cell-output-stdout">
<pre><code>['Plant', 'Leaf', 'Stem', 'MainAxis']
[]
Local cdn resources have problems on chrome/safari when used in jupyter-notebook. 
Local cdn resources have problems on chrome/safari when used in jupyter-notebook. </code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="22">

        <iframe width="900px" height="800px" src="mtg.html" frameborder="0" allowfullscreen=""></iframe>
        
</div>
</div>
</section>
<section id="a-cereal-crop-with-variability" class="level3" data-number="3.7.2">
<h3 data-number="3.7.2" class="anchored" data-anchor-id="a-cereal-crop-with-variability"><span class="header-section-number">3.7.2</span> A cereal crop with variability</h3>
<div id="cell-40" class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Imports</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># from installed packages</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> <span class="op">*</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># from openalea.archicrop</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openalea.archicrop.stand <span class="im">import</span> agronomic_plot</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable plotting with PlantGL</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>gui qt</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co">## Code for generating a random cereal crop from descritive parameters with variability </span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fix a seed</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co">#seed(1)</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the list of plants</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>plants_in_crop<span class="op">=</span>[]</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Fixed parameters for all plants</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>length_plot<span class="op">=</span><span class="dv">5</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>width_plot<span class="op">=</span><span class="dv">5</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>sowing_density<span class="op">=</span><span class="dv">10</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>plant_density<span class="op">=</span><span class="dv">5</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>inter_row<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>nplants, positions, domain, domain_area, unit <span class="op">=</span> agronomic_plot(length_plot, </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>                                                               width_plot, </span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>                                                               sowing_density, </span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>                                                               plant_density, </span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>                                                               inter_row, </span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>                                                               noise<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="co"># For loop over all the plants in the crop</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(nplants):</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Parameters varying among plants</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">300</span><span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>random()<span class="op">-</span><span class="fl">0.5</span>) </span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    nb_phy<span class="op">=</span><span class="dv">15</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>    max_leaf_length<span class="op">=</span><span class="dv">50</span><span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>random()<span class="op">-</span><span class="fl">0.5</span>)</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>    insertion_angle<span class="op">=</span><span class="dv">40</span><span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>random()<span class="op">-</span><span class="fl">0.5</span>)</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>    scurv<span class="op">=</span><span class="fl">0.7</span><span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>random()<span class="op">-</span><span class="fl">0.5</span>)</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>    curvature<span class="op">=</span><span class="dv">70</span><span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>random()<span class="op">-</span><span class="fl">0.5</span>)</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>    phyllotactic_angle<span class="op">=</span><span class="dv">137</span><span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>random()<span class="op">-</span><span class="fl">0.5</span>)</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Functions calls</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>    shoot, g_var <span class="op">=</span> build_shoot(nb_phy<span class="op">=</span>nb_phy, height<span class="op">=</span>height, max_leaf_length<span class="op">=</span>max_leaf_length, </span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>                                wl<span class="op">=</span><span class="fl">0.1</span>, diam_base<span class="op">=</span><span class="fl">2.5</span>, diam_top<span class="op">=</span><span class="fl">1.0</span>, </span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>                                insertion_angle<span class="op">=</span>insertion_angle, scurv<span class="op">=</span>scurv, curvature<span class="op">=</span>curvature, </span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>                                alpha<span class="op">=-</span><span class="fl">2.3</span>, stem_q<span class="op">=</span><span class="fl">1.25</span>, rmax<span class="op">=</span><span class="fl">0.9</span>, skew<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>                                phyllotactic_angle<span class="op">=</span>phyllotactic_angle, phyllotactic_deviation<span class="op">=</span><span class="dv">15</span>, plant_orientation<span class="op">=</span>random()<span class="op">*</span><span class="dv">360</span>, spiral<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill the list of plants</span></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>    plants_in_crop.append(g_var)</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Build and display scene</span></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>scene_var, nump <span class="op">=</span> build_scene(plants_in_crop, positions, leaf_material<span class="op">=</span>Material(nice_green), stem_material<span class="op">=</span>Material(nice_green))</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a><span class="co"># display_scene(scene_var)</span></span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>PlantGL(scene_var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="an-intercrop-organized-in-rows" class="level3" data-number="3.7.3">
<h3 data-number="3.7.3" class="anchored" data-anchor-id="an-intercrop-organized-in-rows"><span class="header-section-number">3.7.3</span> An intercrop organized in rows</h3>
<div id="cell-42" class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Imports</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># from installed packages</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openalea.plantgl.<span class="bu">all</span> <span class="im">import</span> Material, Color3, Shape, Scene, Viewer, Translated, AxisRotated</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable plotting with PlantGL</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>gui qt</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">## Code for generating an intercrop from descritive parameters</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fix a seed</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>seed(<span class="dv">1</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plant(height, nb_phy, max_leaf_length, phyllotactic_angle):</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" return the MTG of a cereal shoot generative from descriptive parameters """</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    shoot, g <span class="op">=</span> build_shoot(nb_phy<span class="op">=</span>nb_phy, height<span class="op">=</span>height, max_leaf_length<span class="op">=</span>max_leaf_length, phyllotactic_angle<span class="op">=</span>phyllotactic_angle, plant_orientation<span class="op">=</span>random()<span class="op">*</span><span class="dv">360</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Organize the plant mixture in alternate rows</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>n_rows <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>len_rows <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>d_inter <span class="op">=</span> <span class="dv">70</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>d_intra <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plant_in_row(i):</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> i<span class="op">%</span>(<span class="dv">4</span><span class="op">*</span>d_inter)<span class="op">==</span><span class="dv">0</span> <span class="kw">or</span> i<span class="op">%</span>(<span class="dv">4</span><span class="op">*</span>d_inter)<span class="op">==</span>d_inter: <span class="cf">return</span> plant(height<span class="op">=</span><span class="dv">1700</span>, nb_phy<span class="op">=</span><span class="dv">18</span>, max_leaf_length<span class="op">=</span><span class="dv">100</span>, phyllotactic_angle<span class="op">=</span><span class="dv">137</span>)</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>     <span class="cf">else</span>: <span class="cf">return</span> plant(height<span class="op">=</span><span class="dv">900</span>, nb_phy<span class="op">=</span><span class="dv">18</span>, max_leaf_length<span class="op">=</span><span class="dv">40</span>, phyllotactic_angle<span class="op">=</span><span class="dv">60</span>)</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>plants_in_intercrop <span class="op">=</span> [plant_in_row(x) <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n_rows<span class="op">*</span>d_inter, d_inter) <span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, len_rows<span class="op">*</span>d_intra, d_intra)]</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>positions<span class="op">=</span>[(x,y,<span class="dv">0</span>) <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n_rows<span class="op">*</span>d_inter, d_inter) <span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, len_rows<span class="op">*</span>d_intra, d_intra)]</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Build and display scene</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>scene_ic, nump <span class="op">=</span> build_scene(plants_in_intercrop, positions, leaf_material<span class="op">=</span>Material(nice_green), stem_material<span class="op">=</span>Material(nice_green))</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a><span class="co"># display_scene(scene_ic)</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>PlantGL(scene_ic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="tillering-branching" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="tillering-branching"><span class="header-section-number">3.8</span> Tillering / Branching</h2>
<p>First, basipetal tillers, straight, oriented according to a certain angle, appearing according to a certain timing</p>
<p>Parameters : number, maximal order, reduction factor, tiller appearance rate (&gt;1 phyllochron or not? several mechanisms depending on species, keep it simple at first), insertion angle (same as leaf ?), tiller curvature, condition related to density (ex: hyp sorghum im field –&gt; no tiller)</p>
<p>For the final structure: When visiting the phytomers from the base, the tillers will be allocated sequentially to the short internodes, following their age and, for a given age, following the ascending order of tiller order, in the limits of the total number of tillers and the maximal order allowed for tillers. Some geometrical features (length, stem diameter, max leaf length, etc.) will be reduced by a given reduction ratio (order-dependent ?). The angles of the tillers</p>
<p>How do we manage the leaves of the short internodes bearing tillers ? Do we consider them at all ?</p>
<p>For growth: the age (start_tt and end_tt) is determined by a tiller appearance rate, expressed as a function of the phyllochron (and the order ?)</p>
<p>see weberpenn Ecomeristem Evers Abichou</p>
</section>
<section id="next-steps" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="next-steps"><span class="header-section-number">3.9</span> Next steps</h2>
<ul>
<li>Modify leaf shape + wavy leaves ?</li>
<li>Adapt for different species (parameters for cereals, some functions for legumes)</li>
</ul>


</section>

</main> <!-- /main -->
<script type="application/vnd.jupyter.widget-state+json">
{"state":{},"version_major":2,"version_minor":0}
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./intro_1.html" class="pagination-link" aria-label="Introduction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./dynamic_model.html" class="pagination-link" aria-label="Dynamic model">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Dynamic model</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>